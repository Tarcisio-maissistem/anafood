import{c as pe,b6 as _a,b7 as ya,b8 as Qe,av as L,j as e,b9 as Ke,ba as Na,bb as Ca,bc as wa,bd as Be,be as Ea,bf as Sa,bg as Ta,bh as Pa,r as f,ar as Ae,bi as ka,bj as Aa,bk as Ia,C as Q,bl as Ra,aQ as he,B as C,b4 as Se,S as $,m as D,n as V,p as H,q as w,aL as Ma,aM as qa,aN as za,aK as N,I as F,bm as Fa,bn as ze,bo as Oa,bp as La,bq as $a,br as Da,bs as Va,bt as Ha,bu as Ga,bv as Qa,bw as Ka,f as B,aS as Te,ab as ce,ac as de,ad as me,ae as ue,b5 as Ba,b as re,d as te,a6 as se,aV as Ie,aH as W,aW as J,x as q,bx as Y,by as Fe,bz as Oe,u as Ue,aT as Ua,e as le,T as we,aj as Za,L as xe,aa as Ja,a_ as Wa,a$ as Ya,b0 as Le,b1 as X,z as $e,b2 as Xa,b3 as ee,bA as es,bB as as,bC as ss,bD as rs,bE as De,ah as ge,bF as ts,bG as ns,aY as is,aI as ls,a2 as os,a3 as cs,a4 as fe,a5 as be,G as ds,H as Ee,bH as ms,R as us,y as Ve}from"./index-v68zVK4x.js";import{T as hs,S as ps,M as xs}from"./theme-toggle-DqinLoEg.js";import{u as Ze}from"./useCompanyId-BPuD7pC1.js";import{R as gs}from"./refresh-cw-C0d5nUEp.js";import{S as fs}from"./square-pen-Bvg6CdWq.js";import{b as bs}from"./browser-CjSdxGTc.js";import{P as js}from"./pen-BFxXknah.js";import{T as vs}from"./truck-BReM8TfE.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=pe("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=pe("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=pe("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=pe("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=pe("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);var G="Accordion",Cs=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[Re,ws,Es]=_a(G),[_e,er]=ya(G,[Es,Qe]),Me=Qe(),Je=L.forwardRef((a,t)=>{const{type:i,...r}=a,g=r,p=r;return e.jsx(Re.Provider,{scope:a.__scopeAccordion,children:i==="multiple"?e.jsx(ks,{...p,ref:t}):e.jsx(Ps,{...g,ref:t})})});Je.displayName=G;var[We,Ss]=_e(G),[Ye,Ts]=_e(G,{collapsible:!1}),Ps=L.forwardRef((a,t)=>{const{value:i,defaultValue:r,onValueChange:g=()=>{},collapsible:p=!1,...b}=a,[j,m]=Ke({prop:i,defaultProp:r??"",onChange:g,caller:G});return e.jsx(We,{scope:a.__scopeAccordion,value:L.useMemo(()=>j?[j]:[],[j]),onItemOpen:m,onItemClose:L.useCallback(()=>p&&m(""),[p,m]),children:e.jsx(Ye,{scope:a.__scopeAccordion,collapsible:p,children:e.jsx(Xe,{...b,ref:t})})})}),ks=L.forwardRef((a,t)=>{const{value:i,defaultValue:r,onValueChange:g=()=>{},...p}=a,[b,j]=Ke({prop:i,defaultProp:r??[],onChange:g,caller:G}),m=L.useCallback(T=>j((R=[])=>[...R,T]),[j]),I=L.useCallback(T=>j((R=[])=>R.filter(E=>E!==T)),[j]);return e.jsx(We,{scope:a.__scopeAccordion,value:b,onItemOpen:m,onItemClose:I,children:e.jsx(Ye,{scope:a.__scopeAccordion,collapsible:!0,children:e.jsx(Xe,{...p,ref:t})})})}),[As,ye]=_e(G),Xe=L.forwardRef((a,t)=>{const{__scopeAccordion:i,disabled:r,dir:g,orientation:p="vertical",...b}=a,j=L.useRef(null),m=Na(j,t),I=ws(i),R=Ca(g)==="ltr",E=wa(a.onKeyDown,P=>{var h;if(!Cs.includes(P.key))return;const z=P.target,x=I().filter(v=>{var O;return!((O=v.ref.current)!=null&&O.disabled)}),d=x.findIndex(v=>v.ref.current===z),l=x.length;if(d===-1)return;P.preventDefault();let c=d;const n=0,u=l-1,o=()=>{c=d+1,c>u&&(c=n)},y=()=>{c=d-1,c<n&&(c=u)};switch(P.key){case"Home":c=n;break;case"End":c=u;break;case"ArrowRight":p==="horizontal"&&(R?o():y());break;case"ArrowDown":p==="vertical"&&o();break;case"ArrowLeft":p==="horizontal"&&(R?y():o());break;case"ArrowUp":p==="vertical"&&y();break}const A=c%l;(h=x[A].ref.current)==null||h.focus()});return e.jsx(As,{scope:i,disabled:r,direction:g,orientation:p,children:e.jsx(Re.Slot,{scope:i,children:e.jsx(Be.div,{...b,"data-orientation":p,ref:m,onKeyDown:r?void 0:E})})})}),ve="AccordionItem",[Is,qe]=_e(ve),ea=L.forwardRef((a,t)=>{const{__scopeAccordion:i,value:r,...g}=a,p=ye(ve,i),b=Ss(ve,i),j=Me(i),m=Ea(),I=r&&b.value.includes(r)||!1,T=p.disabled||a.disabled;return e.jsx(Is,{scope:i,open:I,disabled:T,triggerId:m,children:e.jsx(Sa,{"data-orientation":p.orientation,"data-state":ia(I),...j,...g,ref:t,disabled:T,open:I,onOpenChange:R=>{R?b.onItemOpen(r):b.onItemClose(r)}})})});ea.displayName=ve;var aa="AccordionHeader",sa=L.forwardRef((a,t)=>{const{__scopeAccordion:i,...r}=a,g=ye(G,i),p=qe(aa,i);return e.jsx(Be.h3,{"data-orientation":g.orientation,"data-state":ia(p.open),"data-disabled":p.disabled?"":void 0,...r,ref:t})});sa.displayName=aa;var ke="AccordionTrigger",ra=L.forwardRef((a,t)=>{const{__scopeAccordion:i,...r}=a,g=ye(G,i),p=qe(ke,i),b=Ts(ke,i),j=Me(i);return e.jsx(Re.ItemSlot,{scope:i,children:e.jsx(Ta,{"aria-disabled":p.open&&!b.collapsible||void 0,"data-orientation":g.orientation,id:p.triggerId,...j,...r,ref:t})})});ra.displayName=ke;var ta="AccordionContent",na=L.forwardRef((a,t)=>{const{__scopeAccordion:i,...r}=a,g=ye(G,i),p=qe(ta,i),b=Me(i);return e.jsx(Pa,{role:"region","aria-labelledby":p.triggerId,"data-orientation":g.orientation,...b,...r,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...a.style}})});na.displayName=ta;function ia(a){return a?"open":"closed"}var Rs=Je,Ms=ea,qs=sa,la=ra,oa=na;const zs=Rs,ca=f.forwardRef(({className:a,...t},i)=>e.jsx(Ms,{ref:i,className:Ae("border-b",a),...t}));ca.displayName="AccordionItem";const da=f.forwardRef(({className:a,children:t,...i},r)=>e.jsx(qs,{className:"flex",children:e.jsxs(la,{ref:r,className:Ae("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",a),...i,children:[t,e.jsx(ka,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));da.displayName=la.displayName;const ma=f.forwardRef(({className:a,children:t,...i},r)=>e.jsx(oa,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...i,children:e.jsx("div",{className:Ae("pb-4 pt-0",a),children:t})}));ma.displayName=oa.displayName;const Fs=f.forwardRef(function({element:t,onUpdate:i,onRemove:r,disableRemove:g=!1,disableVisibilityToggle:p=!1,isHighlighted:b=!1},j){const m=f.useRef(null),{attributes:I,listeners:T,setNodeRef:R,transform:E,transition:P,isDragging:z}=Aa({id:t.id});f.useImperativeHandle(j,()=>({scrollIntoView:()=>{var c;(c=m.current)==null||c.scrollIntoView({behavior:"smooth",block:"center"})}}));const x={transform:Ia.Transform.toString(E),transition:P,opacity:z?.5:1},d={small:"P",medium:"M",large:"G",xlarge:"GG"},l={left:"â†",center:"â†”",right:"â†’"};return e.jsx("div",{ref:R,style:x,children:e.jsx("div",{ref:m,children:e.jsx(Q,{className:`p-1 mb-1 transition-all ${b?"ring-2 ring-primary bg-primary/5 animate-pulse":""}`,children:e.jsxs("div",{className:"flex items-start gap-1",children:[e.jsx("button",{className:"cursor-grab active:cursor-grabbing mt-0.5 text-muted-foreground hover:text-foreground",...I,...T,children:e.jsx(Ra,{className:"h-3.5 w-3.5"})}),e.jsxs("div",{className:"flex-1 space-y-0.5",children:[e.jsxs("div",{className:"flex items-center justify-between gap-1",children:[e.jsxs("div",{className:"flex items-center gap-1 flex-1",children:[e.jsx(he,{className:"scale-[0.6]",checked:t.visible,onCheckedChange:c=>i({visible:c}),disabled:p}),e.jsxs("span",{className:"font-medium text-[9px]",children:[t.order,". ",t.label]}),e.jsx("code",{className:"text-[8px] bg-muted px-0.5 py-0.5 rounded",children:t.tag})]}),!g&&e.jsx(C,{variant:"ghost",size:"sm",className:"text-destructive hover:text-destructive hover:bg-destructive/10 h-5 w-5 p-0",onClick:r,children:e.jsx(Se,{className:"h-2.5 w-2.5"})})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-0.5",children:[e.jsxs($,{value:t.fontSize,onValueChange:c=>i({fontSize:c}),children:[e.jsx(D,{className:"h-5 text-[9px] py-0",children:e.jsx(V,{})}),e.jsx(H,{children:Object.entries(d).map(([c,n])=>e.jsx(w,{value:c,className:"text-xs",children:n},c))})]}),e.jsxs($,{value:t.formatting.align,onValueChange:c=>i({formatting:{...t.formatting,align:c}}),children:[e.jsx(D,{className:"h-5 text-[9px] py-0",children:e.jsx(V,{})}),e.jsx(H,{children:Object.entries(l).map(([c,n])=>e.jsx(w,{value:c,className:"text-xs",children:n},c))})]}),e.jsxs("div",{className:"flex gap-0.5",children:[e.jsx(C,{variant:t.formatting.bold?"default":"outline",size:"sm",className:"h-5 w-full font-bold text-[9px] p-0",onClick:()=>i({formatting:{...t.formatting,bold:!t.formatting.bold}}),children:"B"}),e.jsx(C,{variant:t.formatting.underline?"default":"outline",size:"sm",className:"h-5 w-full underline text-[9px] p-0",onClick:()=>i({formatting:{...t.formatting,underline:!t.formatting.underline}}),children:"U"})]}),e.jsxs(Ma,{children:[e.jsx(qa,{asChild:!0,children:e.jsx(C,{variant:t.prefix||t.suffix?"default":"outline",size:"sm",className:"h-5 text-[9px] p-0",children:e.jsx(Ns,{className:"h-2.5 w-2.5"})})}),e.jsx(za,{className:"w-64 p-3",side:"right",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{className:"text-xs",children:"Texto Antes"}),e.jsx(F,{value:t.prefix||"",onChange:c=>i({prefix:c.target.value}),placeholder:"Ex: Tel: ",className:"h-7 text-xs"}),e.jsx(N,{className:"text-xs",children:"Texto Depois"}),e.jsx(F,{value:t.suffix||"",onChange:c=>i({suffix:c.target.value}),placeholder:"Ex: (WhatsApp)",className:"h-7 text-xs"})]})})]}),e.jsxs($,{value:t.separator_below.show?t.separator_below.char:"none",onValueChange:c=>{i(c==="none"?{separator_below:{...t.separator_below,show:!1}}:{separator_below:{show:!0,type:"line",char:c}})},children:[e.jsx(D,{className:"h-5 text-[9px] py-0",children:e.jsx(V,{placeholder:"Sep"})}),e.jsxs(H,{children:[e.jsx(w,{value:"none",className:"text-xs",children:"Sem"}),e.jsx(w,{value:"-",className:"text-xs",children:"-"}),e.jsx(w,{value:"=",className:"text-xs",children:"="}),e.jsx(w,{value:".",className:"text-xs",children:"."})]})]})]})]})]})})})})}),Os={G250:{model:"G250",chars_per_line:48,supports_partial_cut:!0,supports_qr_code:!0,max_print_width_mm:80},"TMT-T20":{model:"TMT-T20",chars_per_line:48,supports_partial_cut:!0,supports_qr_code:!0,max_print_width_mm:80},"Elgin i9":{model:"Elgin i9",chars_per_line:48,supports_partial_cut:!0,supports_qr_code:!0,max_print_width_mm:80},"Elgin i8":{model:"Elgin i8",chars_per_line:48,supports_partial_cut:!0,supports_qr_code:!1,max_print_width_mm:80},"Bematech MP4200TH":{model:"Bematech MP4200TH",chars_per_line:48,supports_partial_cut:!0,supports_qr_code:!0,max_print_width_mm:80}},ae={printer_model:"G250",elements:[],header:{elements:[{id:"nome_empresa",tag:"{nome_empresa}",label:"Nome da Empresa",visible:!0,fontSize:"large",formatting:{bold:!0,underline:!1,align:"center"},order:0},{id:"telefone_empresa",tag:"{telefone_empresa}",label:"Telefone Empresa",visible:!0,fontSize:"medium",formatting:{bold:!1,underline:!1,align:"center"},order:1},{id:"endereco_empresa",tag:"{endereco_empresa}",label:"EndereÃ§o Empresa",visible:!0,fontSize:"small",formatting:{bold:!1,underline:!1,align:"center"},order:2}],separator:{show:!0,type:"equals",char:"="}},body:{elements:[{id:"numero_pedido",tag:"{numero_pedido}",label:"NÃºmero do Pedido",visible:!0,fontSize:"xlarge",formatting:{bold:!0,underline:!1,align:"center"},order:0},{id:"data_hora",tag:"{data_hora}",label:"Data e Hora",visible:!0,fontSize:"medium",formatting:{bold:!1,underline:!1,align:"center"},order:1},{id:"tipo_entrega",tag:"{tipo_entrega}",label:"Tipo de Entrega",visible:!0,fontSize:"medium",formatting:{bold:!0,underline:!1,align:"center"},order:2},{id:"nome_cliente",tag:"{nome_cliente}",label:"Nome do Cliente",visible:!0,fontSize:"medium",formatting:{bold:!0,underline:!1,align:"left"},order:3},{id:"telefone_cliente",tag:"{telefone_cliente}",label:"Telefone do Cliente",visible:!0,fontSize:"medium",formatting:{bold:!1,underline:!1,align:"left"},order:4},{id:"endereco_cliente",tag:"{endereco_cliente}",label:"EndereÃ§o do Cliente",visible:!0,fontSize:"small",formatting:{bold:!1,underline:!1,align:"left"},order:5},{id:"itens",tag:"{itens}",label:"Itens do Pedido",visible:!0,fontSize:"medium",formatting:{bold:!1,underline:!1,align:"left"},order:6}],separator:{show:!0,type:"line",char:"-"}},footer:{elements:[{id:"mensagem_rodape",tag:"{mensagem_rodape}",label:"Mensagem de RodapÃ©",visible:!0,fontSize:"medium",formatting:{bold:!1,underline:!1,align:"center"},order:0}],separator:{show:!0,type:"line",char:"-"}},paper_width:"80mm",chars_per_line:48,allow_custom_chars_per_line:!1,font_sizes:{header:"medium",order_number:"xlarge",item_name:"medium",item_details:"normal",totals:"large"},formatting:{header:{bold:!0,underline:!1,align:"center"},order_number:{bold:!0,underline:!1,align:"center"},customer_info:{bold:!1,underline:!1,align:"left"},items:{bold:!0,underline:!1,align:"left"},item_details:{bold:!1,underline:!1,align:"left"},totals:{bold:!0,underline:!1,align:"left"},footer:{bold:!1,underline:!1,align:"center"}},show_company_logo:!0,show_company_address:!0,show_company_phone:!0,show_order_source:!0,show_customer_info:!0,show_customer_address:!0,show_item_observations:!0,show_order_observations:!0,show_payment_method:!0,show_footer_message:!0,footer_message:"Obrigado pela preferÃªncia!",line_spacing:"normal",cut_paper:!0,extra_feed_lines:4,item_quantity_format:"2x",item_price_position:"next_line",item_extras_prefix:"+ ",item_observations_prefix:"Obs: ",show_item_extras:!0,show_subtotal:!0,show_delivery_fee:!0,encoding:"UTF-8",margin_left:0,margin_right:0,text_mode:"normal",cut_type:"full",line_spacing_multiplier:1,item_spacing:0},je={"{nome_empresa}":{label:"Nome Empresa",icon:"ðŸ¢",category:"header"},"{logo}":{label:"Logo Empresa",icon:"ðŸ–¼ï¸",category:"header"},"{telefone_empresa}":{label:"Telefone Empresa",icon:"ðŸ“ž",category:"header"},"{endereco_empresa}":{label:"EndereÃ§o Empresa",icon:"ðŸ“",category:"header"},"{email_empresa}":{label:"Email Empresa",icon:"ðŸ“§",category:"header"},"{cnpj}":{label:"CNPJ",icon:"ðŸ›ï¸",category:"header"},"{numero_pedido}":{label:"NÃºmero do Pedido",icon:"ðŸ”¢",category:"body"},"{data_hora}":{label:"Data e Hora",icon:"ðŸ“…",category:"body"},"{origem_pedido}":{label:"Origem do Pedido",icon:"ðŸ“±",category:"body"},"{tipo_entrega}":{label:"Tipo de Entrega",icon:"ðŸšš",category:"body"},"{nome_cliente}":{label:"Nome Cliente",icon:"ðŸ‘¤",category:"body"},"{telefone_cliente}":{label:"Telefone Cliente",icon:"ðŸ“ž",category:"body"},"{endereco_cliente}":{label:"EndereÃ§o Cliente",icon:"ðŸ ",category:"body"},"{referencia}":{label:"Ponto de ReferÃªncia",icon:"ðŸ“Œ",category:"body"},"{itens}":{label:"Itens do Pedido",icon:"ðŸ›’",category:"body"},"{observacoes_item}":{label:"ObservaÃ§Ãµes do Item",icon:"ðŸ“",category:"body"},"{observacoes_pedido}":{label:"ObservaÃ§Ãµes do Pedido",icon:"ðŸ’¬",category:"body"},"{subtotal}":{label:"Subtotal",icon:"ðŸ’µ",category:"body"},"{taxa_entrega}":{label:"Taxa de Entrega",icon:"ðŸšš",category:"body"},"{total}":{label:"Total",icon:"ðŸ’°",category:"body"},"{forma_pagamento}":{label:"Forma de Pagamento",icon:"ðŸ’³",category:"body"},"{mensagem_rodape}":{label:"Mensagem de RodapÃ©",icon:"âœ‰ï¸",category:"footer"}};function Ls({config:a,onChange:t,highlightedFieldId:i}){const r=Fa(ze($a),ze(La,{coordinateGetter:Oa})),g=f.useRef({}),[p,b]=f.useState(!1);f.useEffect(()=>{i&&g.current[i]&&!p&&(b(!0),setTimeout(()=>{var l;(l=g.current[i])==null||l.scrollIntoView(),setTimeout(()=>b(!1),1e3)},100))},[i,p]);const m=(()=>{if(a.elements&&a.elements.length>0)return a.elements;const l=[];let c=1;return a.header.elements.forEach(n=>{l.push({...n,order:c++,separator_below:{show:!1,type:"line",char:"-"}})}),a.header.separator.show&&l.length>0&&(l[l.length-1].separator_below=a.header.separator),a.body.elements.forEach(n=>{l.push({...n,order:c++,separator_below:{show:!1,type:"line",char:"-"}})}),a.body.separator.show&&l.length>0&&(l[l.length-1].separator_below=a.body.separator),a.footer.elements.forEach(n=>{l.push({...n,order:c++,separator_below:{show:!1,type:"line",char:"-"}})}),l})(),I=l=>{const{active:c,over:n}=l;if(n&&c.id!==n.id){const u=m.findIndex(A=>A.id===c.id),o=m.findIndex(A=>A.id===n.id),y=Qa(m,u,o).map((A,h)=>({...A,order:h+1}));t({...a,elements:y})}},T=(l,c)=>{const n=m.map(u=>u.id===l?{...u,...c}:u);t({...a,elements:n})},R=l=>{const c=m.filter(n=>n.id!==l).map((n,u)=>({...n,order:u+1}));t({...a,elements:c})},E=Object.keys(je),P=m.map(l=>l.tag),z=E.filter(l=>!P.includes(l)),x=l=>{const c=je[l],n={id:`field_${Date.now()}`,tag:l,label:c.label,visible:!0,order:m.length+1,formatting:{bold:!1,underline:!1,align:"left"},fontSize:"medium",separator_below:{show:!1,type:"line",char:"-"}};t({...a,elements:[...m,n]})};if(!m.some(l=>l.tag==="{itens}")&&m.length>0){const c={id:"items_field",tag:"{itens}",label:je["{itens}"].label,visible:!0,order:m.length+1,formatting:{bold:!1,underline:!1,align:"left"},fontSize:"medium",separator_below:{show:!1,type:"line",char:"-"}};t({...a,elements:[...m,c]})}return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Campos do Cupom"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Arraste para reordenar os campos na impressÃ£o"})]}),e.jsx(Da,{sensors:r,collisionDetection:Va,onDragEnd:I,children:e.jsx(Ha,{items:m.map(l=>l.id),strategy:Ga,children:e.jsx("div",{className:"space-y-2",children:m.sort((l,c)=>l.order-c.order).map(l=>e.jsx(Fs,{ref:c=>{g.current[l.id]=c},element:l,onUpdate:c=>{l.tag==="{itens}"&&c.visible===!1||T(l.id,c)},onRemove:()=>{l.tag!=="{itens}"&&R(l.id)},disableRemove:l.tag==="{itens}",disableVisibilityToggle:l.tag==="{itens}",isHighlighted:i===l.id},l.id))})})}),z.length>0&&e.jsx("div",{className:"pt-4 border-t",children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs($,{onValueChange:l=>x(l),children:[e.jsx(D,{className:"w-full",children:e.jsx(V,{placeholder:"Adicionar novo campo..."})}),e.jsx(H,{children:z.map(l=>{const c=je[l];return e.jsx(w,{value:l,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:c.icon}),e.jsx("span",{children:c.label})]})},l)})})]})})})]})}const U={order_number:"001",created_at:new Date,type:"delivery",source:"whatsapp",customer_name:"JoÃ£o Silva",customer_phone:"(11) 98765-4321",address:"Rua das Flores, 123 - Centro",referencia:"PrÃ³ximo Ã  padaria",items:[{quantity:2,name:"Pizza Margherita G",price:45,extras:[{name:"Borda recheada"},{name:"Catupiry extra"}],observations:"Sem cebola"},{quantity:1,name:"Refrigerante 2L",price:8,extras:[],observations:""},{quantity:3,name:"Pastel de Carne",price:5,extras:[{name:"Com queijo"}],observations:""}],delivery_fee:5,total:113,payment_method:"Dinheiro",observations:"Entregar na portaria",company_name:"EMPRESA EXEMPLO",company_phone:"(11) 1234-5678",company_address:"Rua Exemplo, 123 - Centro - Cidade - SP - CEP: 12345-678",company_email:"contato@empresa.com.br"};function $s({config:a,companyData:t,onTestPrint:i}){var b;const r={...U,company_name:(t==null?void 0:t.fantasy_name)||(t==null?void 0:t.name)||U.company_name,company_phone:(t==null?void 0:t.phone)||U.company_phone,company_address:(t==null?void 0:t.address)||U.company_address,company_email:(t==null?void 0:t.email)||U.company_email,company_cnpj:(t==null?void 0:t.cnpj)||void 0};console.log("ðŸ‘ï¸ ThermalPreview renderizando:",{order_number:r.order_number,customer_name:r.customer_name,items_count:(b=r.items)==null?void 0:b.length,chars_per_line:a.chars_per_line,margin_left:a.margin_left,margin_right:a.margin_right});const g=Ka(r,a,t);console.log("ðŸ“º Preview gerou",g.length,"linhas");const p=j=>{const m=["font-mono","tracking-tighter"];if(j.formatting){switch(j.formatting.bold&&m.push("font-bold"),j.formatting.underline&&m.push("underline"),j.formatting.fontSize){case"small":m.push("text-[8px]");break;case"medium":m.push("text-[10px]");break;case"large":m.push("text-[12px]");break;case"xlarge":m.push("text-[14px]");break;default:m.push("text-[10px]")}switch(j.formatting.align){case"center":m.push("text-center");break;case"right":m.push("text-right");break;default:m.push("text-left")}}else m.push("text-[10px]");return m.join(" ")};return e.jsx("div",{className:"space-y-4",children:e.jsx(Q,{className:"bg-muted/30",children:e.jsxs(B,{className:"py-3 px-1",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-[#F5E6D3] shadow-lg rounded-sm overflow-hidden",style:{width:"320px"},children:e.jsx("div",{className:"p-3 leading-tight",style:{letterSpacing:"-0.5px"},children:g.map((j,m)=>e.jsx("div",{className:p(j),children:j.text},m))})})}),e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsxs(C,{onClick:i,variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(Te,{className:"h-4 w-4"}),"Imprimir Teste"]})})]})})})}function Ds({open:a,onOpenChange:t,value:i,onChange:r}){const[g,p]=f.useState(i),b=()=>{r(g),t(!1)};return e.jsx(ce,{open:a,onOpenChange:t,children:e.jsxs(de,{className:"sm:max-w-[500px]",children:[e.jsx(me,{children:e.jsx(ue,{children:"Editar Mensagem de RodapÃ©"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ba,{value:g,onChange:j=>p(j.target.value),placeholder:"Digite a mensagem que aparecerÃ¡ no rodapÃ© do cupom...",className:"min-h-[150px]"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(C,{variant:"outline",onClick:()=>t(!1),children:"Cancelar"}),e.jsx(C,{onClick:b,children:"Salvar"})]})]})]})})}function S(a,t,i,r={}){return{id:`${a}-${i}`,tag:a,label:t,visible:r.visible??!0,fontSize:r.fontSize??"small",formatting:{bold:r.bold??!1,underline:r.underline??!1,align:r.align??"left"},order:i,separator_below:{show:r.separatorEnabled??!1,type:"line",char:r.separatorChar??"-"}}}const Vs={complete:{name:"Completo (Caixa)",description:"Layout completo com todas as informaÃ§Ãµes do pedido",elements:[S("{nome_empresa}","Nome da Empresa",0,{align:"center"}),S("{telefone_empresa}","Telefone Empresa",1,{align:"center"}),S("{endereco_empresa}","EndereÃ§o Empresa",2,{align:"center"}),S("{cnpj}","CNPJ",3,{visible:!0,align:"center",separatorEnabled:!0,separatorChar:"="}),S("{email_empresa}","Email",4,{visible:!0,align:"center"}),S("{numero_pedido}","NÃºmero do Pedido",5,{visible:!0,align:"center"}),S("{data_hora}","Data e Hora",6,{visible:!0,align:"center"}),S("{origem_pedido}","Origem do Pedido",7,{visible:!0,align:"center"}),S("{tipo_entrega}","Tipo de Entrega",8,{visible:!0,align:"center",separatorEnabled:!0}),S("{nome_cliente}","Nome do Cliente",9,{visible:!0,align:"left"}),S("{telefone_cliente}","Telefone do Cliente",10,{visible:!0,align:"left"}),S("{endereco_cliente}","EndereÃ§o do Cliente",11,{visible:!0,align:"left"}),S("{referencia}","Ponto de ReferÃªncia",12,{visible:!0,align:"left",separatorEnabled:!0,separatorChar:"="}),S("{itens}","Itens do Pedido",13,{visible:!0,align:"left",separatorEnabled:!0}),S("{observacoes_pedido}","ObservaÃ§Ãµes",14,{visible:!0,align:"left",separatorEnabled:!0}),S("{subtotal}","Subtotal",15,{visible:!0,align:"left"}),S("{taxa_entrega}","Taxa de Entrega",16,{visible:!0,align:"left"}),S("{total}","Total",17,{visible:!0,align:"left"}),S("{forma_pagamento}","Forma de Pagamento",18,{visible:!0,align:"left",separatorEnabled:!0,separatorChar:"="}),S("{mensagem_rodape}","Mensagem de RodapÃ©",19,{visible:!0,align:"center",separatorEnabled:!0})]},simplified:{name:"Simplificado (Cozinha/Bar)",description:"Layout simplificado apenas com informaÃ§Ãµes essenciais",elements:[S("{numero_pedido}","NÃºmero do Pedido",0,{visible:!0,align:"center",separatorEnabled:!0,separatorChar:"="}),S("{data_hora}","Data e Hora",1,{visible:!0,align:"center"}),S("{tipo_entrega}","Tipo de Entrega",2,{visible:!0,align:"center",separatorEnabled:!0}),S("{nome_cliente}","Cliente",3,{visible:!0,align:"left",separatorEnabled:!0}),S("{itens}","Itens do Pedido",4,{visible:!0,align:"left",separatorEnabled:!0,separatorChar:"="}),S("{observacoes_pedido}","ObservaÃ§Ãµes",5,{visible:!0,align:"left"})]}};function Hs({sector:a,sectorLabel:t,sectorIcon:i,config:r,availablePrinters:g,companyData:p,onConfigChange:b,onTestPrint:j,onSave:m,onRefreshPrinters:I,isTesting:T,isSaving:R}){const[E,P]=f.useState("custom"),[z,x]=f.useState(null),[d,l]=f.useState(!1),c=f.useRef(m);f.useEffect(()=>{c.current=m},[m]);const n=o=>{b({...r,layout:{...r.layout,...o}})},u=o=>{if(P(o),o!=="custom"){const y=Vs[o];y&&b({...r,layout:{...r.layout,elements:y.elements}})}};return f.useEffect(()=>{if(!r.enabled)return;const o=setTimeout(()=>{c.current()},1500);return()=>clearTimeout(o)},[r,r.enabled]),e.jsxs(Q,{children:[e.jsx(re,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(te,{className:"flex items-center gap-2",children:[e.jsx("span",{children:i}),t]}),e.jsx(he,{checked:r.enabled,onCheckedChange:o=>b({...r,enabled:o})})]})}),e.jsxs(B,{className:"grid grid-cols-1 lg:grid-cols-[1fr,350px] gap-6",children:[e.jsxs("div",{className:"space-y-4 max-h-[calc(100vh-14rem)] overflow-y-auto pr-2 scrollbar-thin",children:[e.jsxs("div",{className:"space-y-3 p-3 border rounded-lg bg-muted/30",children:[e.jsx("h3",{className:"text-sm font-semibold",children:"OpÃ§Ãµes de ImpressÃ£o"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(N,{htmlFor:`template-${a}`,className:"text-xs font-medium",children:"Template Base"}),e.jsxs($,{value:E,onValueChange:u,disabled:!r.enabled,children:[e.jsx(D,{id:`template-${a}`,className:"h-9",children:e.jsx(V,{placeholder:"Selecione"})}),e.jsxs(H,{children:[e.jsx(w,{value:"complete",children:"ðŸ“‹ Completo"}),e.jsx(w,{value:"simplified",children:"ðŸ‘¨â€ðŸ³ Simplificado"}),e.jsx(w,{value:"custom",children:"âš™ï¸ Personalizado"})]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(N,{htmlFor:`printer-${a}`,className:"text-xs font-medium",children:"Impressora"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs($,{value:r.printer_name,onValueChange:o=>b({...r,printer_name:o}),disabled:!r.enabled,children:[e.jsx(D,{id:`printer-${a}`,className:"flex-1 h-9",children:e.jsx(V,{placeholder:"Selecione a impressora"})}),e.jsx(H,{children:g.length===0?e.jsx(w,{value:"no-printer",disabled:!0,children:"Nenhuma impressora encontrada"}):g.map(o=>e.jsx(w,{value:o,children:o},o))})]}),e.jsx(C,{onClick:I,variant:"outline",size:"icon",disabled:!r.enabled,title:"Buscar impressoras",className:"h-9 w-9 shrink-0",children:e.jsx(gs,{className:"h-4 w-4"})})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(N,{htmlFor:`printer-model-${a}`,className:"text-xs font-medium",children:"Modelo da Impressora"}),e.jsxs($,{value:r.layout.printer_model||"G250",onValueChange:o=>n({printer_model:o}),disabled:!r.enabled,children:[e.jsx(D,{id:`printer-model-${a}`,className:"h-9",children:e.jsx(V,{placeholder:"Selecione o modelo"})}),e.jsxs(H,{children:[e.jsx(w,{value:"G250",children:"Gertec G250"}),e.jsx(w,{value:"TMT-T20",children:"Epson TMT-T20"}),e.jsx(w,{value:"Elgin i9",children:"Elgin i9"}),e.jsx(w,{value:"Elgin i8",children:"Elgin i8"}),e.jsx(w,{value:"Bematech MP4200TH",children:"Bematech MP4200TH"})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[Os[r.layout.printer_model||"G250"].chars_per_line," caracteres por linha"]})]})}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(N,{htmlFor:`copies-${a}`,className:"text-xs font-medium",children:"NÂº de Vias"}),e.jsxs($,{value:String(r.copies),onValueChange:o=>b({...r,copies:parseInt(o)}),disabled:!r.enabled,children:[e.jsx(D,{id:`copies-${a}`,className:"h-9",children:e.jsx(V,{})}),e.jsxs(H,{children:[e.jsx(w,{value:"1",children:"1 via"}),e.jsx(w,{value:"2",children:"2 vias"}),e.jsx(w,{value:"3",children:"3 vias"})]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(N,{htmlFor:`margin-left-${a}`,className:"text-xs font-medium",children:"Margem Esq."}),e.jsx(F,{id:`margin-left-${a}`,type:"number",min:"0",max:"20",value:r.layout.margin_left||0,onChange:o=>n({margin_left:parseInt(o.target.value)||0}),disabled:!r.enabled,className:"h-9"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(N,{htmlFor:`margin-right-${a}`,className:"text-xs font-medium",children:"Margem Dir."}),e.jsx(F,{id:`margin-right-${a}`,type:"number",min:"0",max:"20",value:r.layout.margin_right||0,onChange:o=>n({margin_right:parseInt(o.target.value)||0}),disabled:!r.enabled,className:"h-9"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(N,{htmlFor:`extra-feed-${a}`,className:"text-xs font-medium",children:"Linhas ApÃ³s"}),e.jsx(F,{id:`extra-feed-${a}`,type:"number",min:"0",max:"10",value:r.layout.extra_feed_lines||3,onChange:o=>n({extra_feed_lines:parseInt(o.target.value)||3}),disabled:!r.enabled,className:"h-9"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-[200px,1fr] gap-3",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(N,{htmlFor:`spacing-${a}`,className:"text-xs font-medium",children:"EspaÃ§amento"}),e.jsxs($,{value:(r.layout.line_spacing_multiplier||1).toFixed(1),onValueChange:o=>n({line_spacing_multiplier:parseFloat(o)}),disabled:!r.enabled,children:[e.jsx(D,{id:`spacing-${a}`,className:"h-8",children:e.jsx(V,{placeholder:"Normal"})}),e.jsxs(H,{children:[e.jsx(w,{value:"0.5",children:"Muito Compacto"}),e.jsx(w,{value:"0.75",children:"Compacto"}),e.jsx(w,{value:"1.0",children:"Normal"}),e.jsx(w,{value:"1.5",children:"EspaÃ§ado"}),e.jsx(w,{value:"2.0",children:"Muito EspaÃ§ado"})]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(N,{htmlFor:`footer-${a}`,className:"text-xs font-medium",children:"Mensagem de RodapÃ©"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(F,{id:`footer-${a}`,value:r.layout.footer_message||"",onChange:o=>n({footer_message:o.target.value}),placeholder:"Ex: Obrigado pela preferÃªncia!",disabled:!r.enabled,className:"flex-1 h-8"}),e.jsx(C,{variant:"outline",size:"icon",onClick:()=>l(!0),disabled:!r.enabled,title:"Abrir editor de mensagem",className:"h-8 w-8 shrink-0",children:e.jsx(fs,{className:"h-4 w-4"})})]})]})]})]}),e.jsx(Ds,{open:d,onOpenChange:l,value:r.layout.footer_message||"",onChange:o=>n({footer_message:o})}),e.jsx(se,{}),e.jsx(Ls,{config:r.layout,onChange:n,highlightedFieldId:z})]}),e.jsx("div",{className:"hidden lg:block",children:e.jsx("div",{className:"sticky top-4 max-h-[calc(100vh-8rem)]",children:e.jsx($s,{config:r.layout,companyData:p,onTestPrint:j})})})]})]})}const Ge=["caixa","cozinha_1","cozinha_2","copa_bar"],ie={caixa:{label:"Caixa",icon:"ðŸ’°"},cozinha_1:{label:"Cozinha 1",icon:"ðŸ‘¨â€ðŸ³"},cozinha_2:{label:"Cozinha 2",icon:"ðŸ‘©â€ðŸ³"},copa_bar:{label:"Copa/Bar",icon:"ðŸ¹"}};function Gs(){const{companyId:a}=Ze(),t=Ie(),[i,r]=f.useState([]),[g,p]=f.useState(!1),[b,j]=f.useState(null),[m,I]=f.useState(null),[T,R]=f.useState({caixa:{enabled:!0,printer_name:"",copies:1,layout:ae,cut_type:"partial",text_mode:"normal"},cozinha_1:{enabled:!1,printer_name:"",copies:1,layout:ae,cut_type:"partial",text_mode:"normal"},cozinha_2:{enabled:!1,printer_name:"",copies:1,layout:ae,cut_type:"partial",text_mode:"normal"},copa_bar:{enabled:!1,printer_name:"",copies:1,layout:ae,cut_type:"partial",text_mode:"normal"}}),{data:E}=W({queryKey:["company",a],queryFn:async()=>{const{data:n,error:u}=await q.from("companies").select("name, fantasy_name, phone, address, email, cnpj").eq("id",a).single();if(u)throw u;return{name:n.name,fantasy_name:n.fantasy_name,phone:n.phone,address:n.address,email:n.email,cnpj:n.cnpj}},enabled:!!a}),{data:P}=W({queryKey:["store-settings",a],queryFn:async()=>{const{data:n,error:u}=await q.from("store_settings").select("printer_settings").eq("company_id",a).single();if(u)throw u;return n},enabled:!!a,staleTime:0});f.useEffect(()=>{(async()=>{const u=Fe.get();if(u){r(u);return}await z(!1)})()},[]),f.useEffect(()=>{if(!(P!=null&&P.printer_settings))return;const n=P.printer_settings,u={};Ge.forEach(o=>{var A,h,v;const y=(A=n.sectors)==null?void 0:A[o];if(y)u[o]={...y,layout:{...ae,...y.layout}};else{const O=n[o]||((h=n.printers)==null?void 0:h[o]),k=(v=n.layout_configs)==null?void 0:v[o];u[o]={enabled:o==="caixa",printer_name:O||"",copies:1,layout:k?{...ae,...k}:ae,cut_type:"partial",text_mode:"normal"}}}),R(u)},[P]);const z=async(n=!0)=>{p(!0);try{const o=await Oe.getInstance().getPrinters();r(o),Fe.set(o),n&&Y.success(`${o.length} impressora(s) encontrada(s)`)}catch(u){console.error("Erro ao buscar impressoras:",u),n&&Y.error("Certifique-se que o QZ Tray estÃ¡ aberto e rodando")}finally{p(!1)}},x=J({mutationFn:async({sector:n,config:u})=>{const o=(P==null?void 0:P.printer_settings)||{},y={...o,auto_print:o.auto_print??!0,sectors:{...o.sectors||{},[n]:u}},{error:A}=await q.from("store_settings").update({printer_settings:y}).eq("company_id",a);if(A)throw A},onSuccess:(n,{sector:u})=>{t.invalidateQueries({queryKey:["store-settings",a]}),Y.success(`ConfiguraÃ§Ãµes do ${ie[u].label} salvas!`),I(null)},onError:(n,{sector:u})=>{console.error("Erro ao salvar:",n),Y.error(`Erro ao salvar configuraÃ§Ãµes do ${ie[u].label}`),I(null)}}),d=async n=>{try{j(n);const u=T[n];if(!u.printer_name){Y.error("Selecione uma impressora primeiro");return}const o={...U,company_name:(E==null?void 0:E.name)||U.company_name,company_phone:(E==null?void 0:E.phone)||U.company_phone,company_address:(E==null?void 0:E.address)||U.company_address};console.log("ðŸ§ª Teste de impressÃ£o usando MOCK_ORDER:",{order_number:o.order_number,customer_name:o.customer_name,items_count:o.items.length});const y=Oe.getInstance();await y.connect(),await y.printOrder(o,u.printer_name,!1,n,u.layout,u.copies),Y.success("ImpressÃ£o de teste enviada!")}catch(u){console.error("Erro na impressÃ£o de teste:",u),Y.error("Erro ao imprimir teste")}finally{j(null)}},l=n=>{I(n),x.mutate({sector:n,config:T[n]})},c=(n,u)=>{R(o=>({...o,[n]:u}))};return e.jsx("div",{className:"space-y-4",children:e.jsx(zs,{type:"single",collapsible:!0,defaultValue:"caixa",className:"space-y-2",children:Ge.map(n=>e.jsxs(ca,{value:n,className:"border rounded-lg",children:[e.jsx(da,{className:"px-4 hover:no-underline",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:ie[n].icon}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-semibold",children:ie[n].label}),e.jsx("div",{className:"text-sm text-muted-foreground",children:T[n].enabled?T[n].printer_name||"Nenhuma impressora configurada":"Desativado"})]})]})}),e.jsx(ma,{className:"px-4 pb-4",children:e.jsx(Hs,{sector:n,sectorLabel:ie[n].label,sectorIcon:ie[n].icon,config:T[n],availablePrinters:i,companyData:E,onConfigChange:u=>c(n,u),onTestPrint:()=>d(n),onSave:()=>l(n),onRefreshPrinters:()=>z(!0),isTesting:b===n,isSaving:m===n})})]},n))})})}function Qs(){const{toast:a}=Ue(),t=Ie(),{companyId:i}=Ze(),[r,g]=f.useState([]),[p,b]=f.useState(!1),[j,m]=f.useState(!1),[I,T]=f.useState(!1),[R,E]=f.useState(!1),[P,z]=f.useState(null);f.useState(null);const[x,d]=f.useState({}),[l,c]=f.useState({table_number:"",name:"",capacity:4,area_id:""}),[n,u]=f.useState({name:""}),[o,y]=f.useState({start:1,end:10,area_id:"",capacity:4}),{data:A=[],isLoading:h}=W({queryKey:["table-areas",i],queryFn:async()=>{if(!i)return[];const{data:s,error:_}=await q.from("table_areas").select("*").eq("company_id",i).order("sort_order");if(_)throw _;return s},enabled:!!i}),{data:v=[],isLoading:O}=W({queryKey:["tables-settings",i],queryFn:async()=>{if(!i)return[];const{data:s,error:_}=await q.from("tables").select("*, table_areas(name)").eq("company_id",i).order("table_number");if(_)throw _;return s.map(M=>{var Z;return{...M,area_name:(Z=M.table_areas)==null?void 0:Z.name}})},enabled:!!i}),{data:k}=W({queryKey:["company-subdomain",i],queryFn:async()=>{if(!i)return null;const{data:s,error:_}=await q.from("companies").select("subdomain, name").eq("id",i).single();if(_)throw _;return s},enabled:!!i});f.useEffect(()=>{k!=null&&k.subdomain&&v.length>0&&(async()=>{const _={};for(const M of v){const Z=`${window.location.origin}/${k.subdomain}?mesa=${M.table_number}`;try{_[M.id]=await bs.toDataURL(Z,{width:200,margin:1,color:{dark:"#000000",light:"#ffffff"}})}catch(va){console.error("Error generating QR code:",va)}}d(_)})()},[k==null?void 0:k.subdomain,v]);const ne=J({mutationFn:async s=>{if(!i)throw new Error("Company ID not found");const{error:_}=await q.from("tables").insert({company_id:i,table_number:s.table_number,name:s.name||null,capacity:s.capacity||null,area_id:s.area_id||null});if(_)throw _},onSuccess:()=>{t.invalidateQueries({queryKey:["tables-settings"]}),b(!1),c({table_number:"",name:"",capacity:4,area_id:""}),a({title:"Mesa criada com sucesso"})},onError:s=>{a({title:"Erro ao criar mesa",description:s.message,variant:"destructive"})}}),oe=J({mutationFn:async({id:s,..._})=>{const{error:M}=await q.from("tables").update({table_number:_.table_number,name:_.name||null,capacity:_.capacity||null,area_id:_.area_id||null}).eq("id",s);if(M)throw M},onSuccess:()=>{t.invalidateQueries({queryKey:["tables-settings"]}),b(!1),z(null),a({title:"Mesa atualizada"})},onError:s=>{a({title:"Erro ao atualizar mesa",description:s.message,variant:"destructive"})}}),Ne=J({mutationFn:async s=>{const{error:_}=await q.from("tables").delete().eq("id",s);if(_)throw _},onSuccess:()=>{t.invalidateQueries({queryKey:["tables-settings"]}),a({title:"Mesa removida"})},onError:s=>{a({title:"Erro ao remover mesa",description:s.message,variant:"destructive"})}}),K=J({mutationFn:async s=>{if(!i)throw new Error("Company ID not found");const{error:_}=await q.from("table_areas").insert({company_id:i,name:s,sort_order:A.length});if(_)throw _},onSuccess:()=>{t.invalidateQueries({queryKey:["table-areas"]}),m(!1),u({name:""}),a({title:"Ãrea criada"})},onError:s=>{a({title:"Erro ao criar Ã¡rea",description:s.message,variant:"destructive"})}}),ua=J({mutationFn:async s=>{const{error:_}=await q.from("table_areas").delete().eq("id",s);if(_)throw _},onSuccess:()=>{t.invalidateQueries({queryKey:["table-areas"]}),a({title:"Ãrea removida"})},onError:s=>{a({title:"Erro ao remover Ã¡rea",description:s.message,variant:"destructive"})}}),Ce=J({mutationFn:async s=>{if(!i)throw new Error("Company ID not found");const _=[];for(let Z=s.start;Z<=s.end;Z++)_.push({company_id:i,table_number:String(Z),capacity:s.capacity,area_id:s.area_id||null});const{error:M}=await q.from("tables").insert(_);if(M)throw M},onSuccess:()=>{t.invalidateQueries({queryKey:["tables-settings"]}),T(!1),y({start:1,end:10,area_id:"",capacity:4}),a({title:"Mesas criadas em lote"})},onError:s=>{a({title:"Erro ao criar mesas",description:s.message,variant:"destructive"})}}),ha=s=>{z(s),c({table_number:s.table_number,name:s.name||"",capacity:s.capacity||4,area_id:s.area_id||""}),b(!0)},pa=()=>{P?oe.mutate({id:P.id,...l}):ne.mutate(l)},xa=s=>{g(_=>_.includes(s)?_.filter(M=>M!==s):[..._,s])},ga=()=>{r.length===v.length?g([]):g(v.map(s=>s.id))},fa=()=>{if(r.length===0){a({title:"Selecione ao menos uma mesa",variant:"destructive"});return}E(!0)},ba=()=>{const s=window.open("","_blank");if(!s)return;const _=v.filter(M=>r.includes(M.id));s.document.write(`
      <!DOCTYPE html>
      <html>
      <head>
        <title>QR Codes - ${(k==null?void 0:k.name)||"Mesas"}</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }
          .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
          .qr-card { 
            border: 2px solid #000; 
            padding: 20px; 
            text-align: center; 
            break-inside: avoid;
          }
          .qr-card img { max-width: 150px; }
          .table-number { font-size: 24px; font-weight: bold; margin: 10px 0; }
          .company-name { font-size: 14px; color: #666; }
          .instructions { font-size: 12px; color: #888; margin-top: 10px; }
          @media print {
            .grid { grid-template-columns: repeat(3, 1fr); }
          }
        </style>
      </head>
      <body>
        <div class="grid">
          ${_.map(M=>`
            <div class="qr-card">
              <div class="company-name">${(k==null?void 0:k.name)||""}</div>
              <div class="table-number">Mesa ${M.table_number}</div>
              <img src="${x[M.id]||""}" alt="QR Code Mesa ${M.table_number}" />
              <div class="instructions">Escaneie para fazer seu pedido</div>
            </div>
          `).join("")}
        </div>
        <script>
          window.onload = function() { window.print(); window.close(); }
        <\/script>
      </body>
      </html>
    `),s.document.close(),E(!1)},ja=h||O;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(Q,{children:[e.jsx(re,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(te,{className:"flex items-center gap-2",children:[e.jsx(Ua,{className:"h-5 w-5"}),"Ãreas"]}),e.jsx(le,{children:"Organize suas mesas por Ã¡reas (SalÃ£o, Varanda, etc.)"})]}),e.jsxs(C,{size:"sm",onClick:()=>m(!0),children:[e.jsx(we,{className:"h-4 w-4 mr-1"})," Nova Ãrea"]})]})}),e.jsx(B,{children:A.length===0?e.jsx("p",{className:"text-muted-foreground text-sm",children:"Nenhuma Ã¡rea cadastrada"}):e.jsx("div",{className:"flex flex-wrap gap-2",children:A.map(s=>e.jsxs(Za,{variant:"secondary",className:"py-2 px-3 gap-2",children:[s.name,e.jsx(C,{variant:"ghost",size:"icon",className:"h-4 w-4 hover:bg-destructive hover:text-destructive-foreground",onClick:()=>ua.mutate(s.id),children:e.jsx(Se,{className:"h-3 w-3"})})]},s.id))})})]}),e.jsxs(Q,{children:[e.jsx(re,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(te,{className:"flex items-center gap-2",children:[e.jsx(Pe,{className:"h-5 w-5"}),"Mesas"]}),e.jsx(le,{children:"Cadastre e gerencie suas mesas"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(C,{variant:"outline",size:"sm",onClick:fa,disabled:r.length===0,children:[e.jsx(Te,{className:"h-4 w-4 mr-1"})," Imprimir QR (",r.length,")"]}),e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>T(!0),children:[e.jsx(we,{className:"h-4 w-4 mr-1"})," Gerar Lote"]}),e.jsxs(C,{size:"sm",onClick:()=>b(!0),children:[e.jsx(we,{className:"h-4 w-4 mr-1"})," Nova Mesa"]})]})]})}),e.jsx(B,{children:ja?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(xe,{className:"h-6 w-6 animate-spin"})}):v.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Pe,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Nenhuma mesa cadastrada"}),e.jsx("p",{className:"text-sm",children:'Clique em "Nova Mesa" ou "Gerar Lote" para comeÃ§ar'})]}):e.jsx(Ja,{className:"h-[400px]",children:e.jsxs(Wa,{children:[e.jsx(Ya,{children:e.jsxs(Le,{children:[e.jsx(X,{className:"w-12",children:e.jsx($e,{checked:r.length===v.length&&v.length>0,onCheckedChange:ga})}),e.jsx(X,{children:"NÃºmero"}),e.jsx(X,{children:"Nome"}),e.jsx(X,{children:"Ãrea"}),e.jsx(X,{children:"Capacidade"}),e.jsx(X,{children:"QR Code"}),e.jsx(X,{className:"w-12"})]})}),e.jsx(Xa,{children:v.map(s=>e.jsxs(Le,{children:[e.jsx(ee,{children:e.jsx($e,{checked:r.includes(s.id),onCheckedChange:()=>xa(s.id)})}),e.jsx(ee,{className:"font-medium",children:s.table_number}),e.jsx(ee,{children:s.name||"-"}),e.jsx(ee,{children:s.area_name||"-"}),e.jsx(ee,{children:s.capacity||"-"}),e.jsx(ee,{children:x[s.id]&&e.jsx("img",{src:x[s.id],alt:`QR Mesa ${s.table_number}`,className:"h-10 w-10"})}),e.jsx(ee,{children:e.jsxs(es,{children:[e.jsx(as,{asChild:!0,children:e.jsx(C,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(ss,{className:"h-4 w-4"})})}),e.jsxs(rs,{align:"end",children:[e.jsxs(De,{onClick:()=>ha(s),children:[e.jsx(js,{className:"h-4 w-4 mr-2"})," Editar"]}),e.jsxs(De,{className:"text-destructive",onClick:()=>Ne.mutate(s.id),children:[e.jsx(Se,{className:"h-4 w-4 mr-2"})," Excluir"]})]})]})})]},s.id))})]})})})]}),e.jsx(ce,{open:p,onOpenChange:b,children:e.jsxs(de,{children:[e.jsx(me,{children:e.jsx(ue,{children:P?"Editar Mesa":"Nova Mesa"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{children:"NÃºmero *"}),e.jsx(F,{value:l.table_number,onChange:s=>c({...l,table_number:s.target.value}),placeholder:"1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{children:"Nome (opcional)"}),e.jsx(F,{value:l.name,onChange:s=>c({...l,name:s.target.value}),placeholder:"VIP 1"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{children:"Ãrea"}),e.jsxs($,{value:l.area_id||"none",onValueChange:s=>c({...l,area_id:s==="none"?"":s}),children:[e.jsx(D,{children:e.jsx(V,{placeholder:"Selecione"})}),e.jsxs(H,{children:[e.jsx(w,{value:"none",children:"Nenhuma"}),A.map(s=>e.jsx(w,{value:s.id,children:s.name},s.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{children:"Capacidade"}),e.jsx(F,{type:"number",value:l.capacity,onChange:s=>c({...l,capacity:parseInt(s.target.value)||4}),min:1})]})]})]}),e.jsxs(ge,{children:[e.jsx(C,{variant:"outline",onClick:()=>b(!1),children:"Cancelar"}),e.jsxs(C,{onClick:pa,disabled:!l.table_number||ne.isPending||oe.isPending,children:[(ne.isPending||oe.isPending)&&e.jsx(xe,{className:"h-4 w-4 mr-2 animate-spin"}),P?"Salvar":"Criar"]})]})]})}),e.jsx(ce,{open:j,onOpenChange:m,children:e.jsxs(de,{className:"sm:max-w-sm",children:[e.jsx(me,{children:e.jsx(ue,{children:"Nova Ãrea"})}),e.jsxs("div",{className:"py-4",children:[e.jsx(N,{children:"Nome da Ãrea *"}),e.jsx(F,{value:n.name,onChange:s=>u({name:s.target.value}),placeholder:"Ex: SalÃ£o, Varanda, TerraÃ§o",className:"mt-2"})]}),e.jsxs(ge,{children:[e.jsx(C,{variant:"outline",onClick:()=>m(!1),children:"Cancelar"}),e.jsxs(C,{onClick:()=>K.mutate(n.name),disabled:!n.name||K.isPending,children:[K.isPending&&e.jsx(xe,{className:"h-4 w-4 mr-2 animate-spin"}),"Criar"]})]})]})}),e.jsx(ce,{open:I,onOpenChange:T,children:e.jsxs(de,{children:[e.jsx(me,{children:e.jsx(ue,{children:"Gerar Mesas em Lote"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{children:"De (nÃºmero)"}),e.jsx(F,{type:"number",value:o.start,onChange:s=>y({...o,start:parseInt(s.target.value)||1}),min:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{children:"AtÃ© (nÃºmero)"}),e.jsx(F,{type:"number",value:o.end,onChange:s=>y({...o,end:parseInt(s.target.value)||10}),min:1})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{children:"Ãrea"}),e.jsxs($,{value:o.area_id||"none",onValueChange:s=>y({...o,area_id:s==="none"?"":s}),children:[e.jsx(D,{children:e.jsx(V,{placeholder:"Selecione"})}),e.jsxs(H,{children:[e.jsx(w,{value:"none",children:"Nenhuma"}),A.map(s=>e.jsx(w,{value:s.id,children:s.name},s.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{children:"Capacidade"}),e.jsx(F,{type:"number",value:o.capacity,onChange:s=>y({...o,capacity:parseInt(s.target.value)||4}),min:1})]})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["SerÃ£o criadas ",Math.max(0,o.end-o.start+1)," mesas"]})]}),e.jsxs(ge,{children:[e.jsx(C,{variant:"outline",onClick:()=>T(!1),children:"Cancelar"}),e.jsxs(C,{onClick:()=>Ce.mutate(o),disabled:o.end<o.start||Ce.isPending,children:[Ce.isPending&&e.jsx(xe,{className:"h-4 w-4 mr-2 animate-spin"}),"Criar Mesas"]})]})]})}),e.jsx(ce,{open:R,onOpenChange:E,children:e.jsxs(de,{className:"sm:max-w-2xl",children:[e.jsx(me,{children:e.jsx(ue,{children:"Imprimir QR Codes"})}),e.jsxs("div",{className:"py-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:[r.length," mesa(s) selecionada(s) para impressÃ£o"]}),e.jsx("div",{className:"grid grid-cols-3 gap-4 max-h-[400px] overflow-y-auto",children:v.filter(s=>r.includes(s.id)).map(s=>e.jsxs("div",{className:"border rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:k==null?void 0:k.name}),e.jsxs("p",{className:"font-bold",children:["Mesa ",s.table_number]}),x[s.id]&&e.jsx("img",{src:x[s.id],alt:`QR ${s.table_number}`,className:"mx-auto my-2"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Escaneie para pedir"})]},s.id))})]}),e.jsxs(ge,{children:[e.jsx(C,{variant:"outline",onClick:()=>E(!1),children:"Cancelar"}),e.jsxs(C,{onClick:ba,children:[e.jsx(Te,{className:"h-4 w-4 mr-2"})," Imprimir"]})]})]})})]})}function ar(){const{toast:a}=Ue(),t=Ie(),{theme:i,setTheme:r}=ts(),{palette:g,setPalette:p,palettes:b}=ns(),[j,m]=f.useState("general"),[I,T]=f.useState([]),[R,E]=f.useState(!1),[P,z]=f.useState({caixa:"",cozinha1:"",cozinha2:"",copa_bar:""}),{data:x}=W({queryKey:["profile"],queryFn:async()=>{const{data:{user:h}}=await q.auth.getUser();if(!h)throw new Error("User not found");const{data:v,error:O}=await q.from("profiles").select("company_id").eq("id",h.id).single();if(O)throw O;return v}}),{data:d,isLoading:l}=W({queryKey:["store-settings",x==null?void 0:x.company_id],queryFn:async()=>{if(!(x!=null&&x.company_id))return null;const{data:h,error:v}=await q.from("store_settings").select("*").eq("company_id",x.company_id).single();if(v&&v.code!=="PGRST116")throw v;return h||{store_open:!0,auto_accept:!1,sound_enabled:!0,delivery_time:30,pickup_time:45,alert_time:60,order_numbering_mode:"sequential",order_numbering_reset_time:"00:00"}},enabled:!!(x!=null&&x.company_id)}),{data:c}=W({queryKey:["next-order-number",x==null?void 0:x.company_id,d==null?void 0:d.order_numbering_mode],queryFn:async()=>{if(!(x!=null&&x.company_id))return null;const h=(d==null?void 0:d.order_numbering_mode)||"sequential",v=(d==null?void 0:d.order_numbering_reset_time)||"00:00";let O=q.from("orders").select("order_number").eq("company_id",x.company_id).order("created_at",{ascending:!1}).limit(1);if(h==="daily"){const ne=new Date,[oe,Ne]=v.split(":").map(Number),K=new Date(ne);K.setHours(oe,Ne,0,0),ne<K&&K.setDate(K.getDate()-1),O=O.gte("created_at",K.toISOString())}const{data:k}=await O.maybeSingle();return k!=null&&k.order_number?String(parseInt(k.order_number)+1).padStart(3,"0"):"001"},enabled:!!(x!=null&&x.company_id)&&!!d});f.useEffect(()=>{d!=null&&d.printer_settings&&z({caixa:d.printer_settings.caixa||"",cozinha1:d.printer_settings.cozinha1||"",cozinha2:d.printer_settings.cozinha2||"",copa_bar:d.printer_settings.copa_bar||""})},[d]);const n=f.useRef(!1);f.useEffect(()=>{j==="printer"&&!n.current&&d&&(n.current=!0,u(!1))},[j,d]);const u=async(h=!0)=>{E(!0);try{const v=await is.getPrinters();T(v),h&&a({title:"Sucesso",description:`${v.length} impressora(s) encontrada(s)`})}catch(v){console.error("Erro ao buscar impressoras:",v),h&&a({title:"Erro",description:"Certifique-se que o QZ Tray estÃ¡ aberto e rodando",variant:"destructive"})}finally{E(!1)}},o=J({mutationFn:async h=>{if(!(x!=null&&x.company_id))throw new Error("Company ID not found");const{error:v}=await q.from("store_settings").upsert({company_id:x.company_id,...h},{onConflict:"company_id"});if(v)throw v},onSuccess:()=>{t.invalidateQueries({queryKey:["store-settings"]}),t.invalidateQueries({queryKey:["next-order-number"]}),a({title:"Sucesso",description:"ConfiguraÃ§Ãµes atualizadas"})},onError:h=>{console.error("Error updating settings:",h),a({title:"Erro",description:"Erro ao atualizar configuraÃ§Ãµes",variant:"destructive"})}}),y=(h,v)=>{o.mutate({[h]:v})},A=async()=>{if(!confirm("Tem certeza que deseja zerar a contagem de pedidos? O prÃ³ximo pedido serÃ¡ #001."))return;const h=new Date,v=`${String(h.getHours()).padStart(2,"0")}:${String(h.getMinutes()).padStart(2,"0")}`;o.mutate({order_numbering_mode:"daily",order_numbering_reset_time:v}),a({title:"Sucesso",description:"Contagem zerada! PrÃ³ximo pedido serÃ¡ #001"})};return e.jsxs("div",{className:"flex flex-col h-screen",children:[e.jsx("header",{className:"bg-card/50 backdrop-blur border-b border-border sticky top-0 z-10",children:e.jsx("div",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(ls,{className:"lg:hidden"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"ConfiguraÃ§Ãµes"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Gerencie as configuraÃ§Ãµes do sistema"})]})]}),e.jsx(hs,{})]})})}),e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsxs(os,{value:j,onValueChange:m,className:"space-y-6",children:[e.jsxs(cs,{className:"grid grid-cols-4 w-full max-w-4xl",children:[e.jsx(fe,{value:"general",children:"Geral"}),e.jsxs(fe,{value:"tables",children:[e.jsx(Pe,{className:"h-4 w-4 mr-1"}),"Mesas"]}),e.jsx(fe,{value:"appearance",children:"AparÃªncia"}),e.jsx(fe,{value:"print",children:"ImpressÃ£o"})]}),e.jsxs(be,{value:"general",className:"space-y-6",children:[e.jsxs(Q,{children:[e.jsxs(re,{children:[e.jsxs(te,{className:"flex items-center gap-2",children:[e.jsx(ds,{className:"h-5 w-5"}),"ConfiguraÃ§Ãµes da Loja"]}),e.jsx(le,{children:"Configure o funcionamento bÃ¡sico da sua loja"})]}),e.jsxs(B,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(N,{htmlFor:"store-open",children:"Loja Aberta"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Permite que clientes faÃ§am pedidos"})]}),e.jsx(he,{id:"store-open",checked:d==null?void 0:d.store_open,onCheckedChange:h=>y("store_open",h),disabled:l})]}),e.jsx(se,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(N,{htmlFor:"auto-accept",children:"Aceitar Pedidos Automaticamente"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pedidos sÃ£o aceitos sem aprovaÃ§Ã£o manual"})]}),e.jsx(he,{id:"auto-accept",checked:d==null?void 0:d.auto_accept,onCheckedChange:h=>y("auto_accept",h),disabled:l})]}),e.jsx(se,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(N,{htmlFor:"pickup-time",children:[e.jsx(Ee,{className:"inline h-4 w-4 mr-2"}),"Tempo de Retirada (min)"]}),e.jsx(F,{id:"pickup-time",type:"number",value:(d==null?void 0:d.pickup_time)??45,onChange:h=>y("pickup_time",parseInt(h.target.value)||45),disabled:l})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(N,{htmlFor:"delivery-time",children:[e.jsx(vs,{className:"inline h-4 w-4 mr-2"}),"Tempo de Entrega (min)"]}),e.jsx(F,{id:"delivery-time",type:"number",value:(d==null?void 0:d.delivery_time)??30,onChange:h=>y("delivery_time",parseInt(h.target.value)||30),disabled:l})]})]}),e.jsx(se,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(N,{htmlFor:"sound-enabled",children:[e.jsx(ms,{className:"inline h-4 w-4 mr-2"}),"Som de NotificaÃ§Ã£o"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Tocar som quando receber novos pedidos"})]}),e.jsx(he,{id:"sound-enabled",checked:d==null?void 0:d.sound_enabled,onCheckedChange:h=>y("sound_enabled",h),disabled:l})]}),e.jsx(se,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(N,{htmlFor:"delayed-alert",children:[e.jsx(Ee,{className:"inline h-4 w-4 mr-2"}),"Alerta de Pedidos em Atraso (min)"]}),e.jsxs($,{value:String((d==null?void 0:d.alert_time)??10),onValueChange:h=>y("alert_time",parseInt(h)),disabled:l,children:[e.jsx(D,{id:"delayed-alert",children:e.jsx(V,{})}),e.jsx(H,{children:[5,10,15,20,30].map(h=>e.jsxs(w,{value:String(h),children:[h," minutos"]},h))})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Tempo em minutos para alertar pedidos em atraso (apenas Em Preparo)"})]})]})]}),e.jsxs(Q,{children:[e.jsxs(re,{children:[e.jsxs(te,{className:"flex items-center gap-2",children:[e.jsx(_s,{className:"h-5 w-5"}),"NumeraÃ§Ã£o de Pedidos"]}),e.jsx(le,{children:"Configure como os nÃºmeros dos pedidos sÃ£o gerados"})]}),e.jsxs(B,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(N,{children:"Modo de NumeraÃ§Ã£o"}),e.jsxs(us,{value:(d==null?void 0:d.order_numbering_mode)||"sequential",onValueChange:h=>y("order_numbering_mode",h),disabled:l,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-start space-x-3 p-4 border rounded-lg hover:bg-muted/50 cursor-pointer",children:[e.jsx(Ve,{value:"sequential",id:"sequential",className:"mt-1"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(N,{htmlFor:"sequential",className:"font-medium cursor-pointer",children:"Sequencial"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Nunca reinicia. Os nÃºmeros continuam crescendo indefinidamente (001, 002, 003...)"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3 p-4 border rounded-lg hover:bg-muted/50 cursor-pointer",children:[e.jsx(Ve,{value:"daily",id:"daily",className:"mt-1"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(N,{htmlFor:"daily",className:"font-medium cursor-pointer",children:"DiÃ¡ria"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Reinicia todo dia na hora configurada. ComeÃ§a em 001 a cada dia."})]})]})]})]}),(d==null?void 0:d.order_numbering_mode)==="daily"&&e.jsxs(e.Fragment,{children:[e.jsx(se,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(N,{htmlFor:"reset-time",children:[e.jsx(Ee,{className:"inline h-4 w-4 mr-2"}),"Hora de Reset"]}),e.jsx(F,{id:"reset-time",type:"time",value:(d==null?void 0:d.order_numbering_reset_time)||"00:00",onChange:h=>y("order_numbering_reset_time",h.target.value),disabled:l,className:"w-32"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Hora em que a numeraÃ§Ã£o reinicia para 001"})]})]}),e.jsx(se,{}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"PrÃ³ximo pedido serÃ¡:"}),e.jsxs("p",{className:"text-2xl font-bold text-primary",children:["#",c||"001"]})]}),e.jsxs(C,{variant:"outline",size:"sm",onClick:A,disabled:l||o.isPending,children:[e.jsx(ys,{className:"h-4 w-4 mr-2"}),"Zerar Contagem"]})]})]})]})]}),e.jsxs(be,{value:"appearance",className:"space-y-6",children:[e.jsxs(Q,{children:[e.jsxs(re,{children:[e.jsxs(te,{className:"flex items-center gap-2",children:[e.jsx(He,{className:"h-5 w-5"}),"Tema"]}),e.jsx(le,{children:"Escolha entre tema claro ou escuro"})]}),e.jsx(B,{className:"space-y-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(N,{children:"Modo de Tema"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(C,{variant:i==="light"?"default":"outline",className:"h-auto flex-col gap-2 p-4",onClick:()=>r("light"),children:[e.jsx(ps,{className:"h-6 w-6"}),e.jsx("span",{children:"Claro"})]}),e.jsxs(C,{variant:i==="dark"?"default":"outline",className:"h-auto flex-col gap-2 p-4",onClick:()=>r("dark"),children:[e.jsx(xs,{className:"h-6 w-6"}),e.jsx("span",{children:"Escuro"})]})]})]})})]}),e.jsxs(Q,{children:[e.jsxs(re,{children:[e.jsxs(te,{className:"flex items-center gap-2",children:[e.jsx(He,{className:"h-5 w-5"}),"Paleta de Cores"]}),e.jsx(le,{children:"Personalize as cores do sistema escolhendo uma paleta"})]}),e.jsx(B,{className:"space-y-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(N,{children:"Escolha uma Paleta"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[e.jsxs(C,{variant:g==="purple"?"default":"outline",className:"h-auto flex-col gap-3 p-4",onClick:()=>p("purple"),children:[e.jsx("div",{className:"w-full h-12 rounded-md bg-gradient-to-br from-purple-500 to-purple-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Roxo"})]}),e.jsxs(C,{variant:g==="blue"?"default":"outline",className:"h-auto flex-col gap-3 p-4",onClick:()=>p("blue"),children:[e.jsx("div",{className:"w-full h-12 rounded-md bg-gradient-to-br from-blue-500 to-blue-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Azul"})]}),e.jsxs(C,{variant:g==="green"?"default":"outline",className:"h-auto flex-col gap-3 p-4",onClick:()=>p("green"),children:[e.jsx("div",{className:"w-full h-12 rounded-md bg-gradient-to-br from-green-500 to-green-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Verde"})]}),e.jsxs(C,{variant:g==="orange"?"default":"outline",className:"h-auto flex-col gap-3 p-4",onClick:()=>p("orange"),children:[e.jsx("div",{className:"w-full h-12 rounded-md bg-gradient-to-br from-orange-500 to-orange-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Laranja"})]}),e.jsxs(C,{variant:g==="pink"?"default":"outline",className:"h-auto flex-col gap-3 p-4",onClick:()=>p("pink"),children:[e.jsx("div",{className:"w-full h-12 rounded-md bg-gradient-to-br from-pink-500 to-pink-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Rosa"})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"A paleta de cores serÃ¡ aplicada em todos os elementos do sistema"})]})})]})]}),e.jsx(be,{value:"tables",className:"space-y-6",children:e.jsx(Qs,{})}),e.jsx(be,{value:"print",className:"space-y-6",children:x!=null&&x.company_id?e.jsx(Gs,{}):e.jsx(Q,{children:e.jsx(B,{className:"py-10",children:e.jsx("p",{className:"text-center text-muted-foreground",children:"Erro ao carregar configuraÃ§Ãµes. Por favor, recarregue a pÃ¡gina."})})})})]})})]})}export{ar as Settings};
