import{r as u,u as C,j as e,aK as b,B as y,X as B,V as F,U as L,x as n}from"./index-v68zVK4x.js";function S({companyId:c,currentLogoUrl:o,companyName:m,onLogoUpdate:p}){const[a,i]=u.useState(!1),[f,l]=u.useState(o||null),{toast:r}=C();u.useEffect(()=>{l(o||null)},[o]);const E=async s=>{var x;const t=(x=s.target.files)==null?void 0:x[0];if(t){if(!t.type.startsWith("image/")){r({title:"Erro",description:"Por favor, selecione uma imagem válida",variant:"destructive"});return}if(t.size>5*1024*1024){r({title:"Erro",description:"A imagem deve ter no máximo 5MB",variant:"destructive"});return}i(!0);try{const d=URL.createObjectURL(t);l(d);const U=t.name.split(".").pop(),g=`${c}/logo.${U}`,{error:h}=await n.storage.from("company-logos").upload(g,t,{upsert:!0});if(h)throw h;const{data:{publicUrl:v}}=n.storage.from("company-logos").getPublicUrl(g),{error:j}=await n.from("companies").update({logo_url:v}).eq("id",c);if(j)throw j;p(v),r({title:"Sucesso",description:"Logo atualizado com sucesso"})}catch(d){console.error("Error uploading logo:",d),r({title:"Erro",description:"Erro ao fazer upload do logo",variant:"destructive"}),l(o||null)}finally{i(!1)}}},w=async()=>{try{i(!0);const{error:s}=await n.from("companies").update({logo_url:null}).eq("id",c);if(s)throw s;l(null),p(""),r({title:"Sucesso",description:"Logo removido com sucesso"})}catch(s){console.error("Error removing logo:",s),r({title:"Erro",description:"Erro ao remover logo",variant:"destructive"})}finally{i(!1)}},N=()=>m.split(" ").map(s=>s[0]).join("").substring(0,2).toUpperCase();return e.jsxs("div",{className:"space-y-4",children:[e.jsx(b,{children:"Logo da Empresa"}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"relative w-32 h-32 rounded-lg border-2 border-dashed border-border flex items-center justify-center overflow-hidden bg-muted",children:f?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:f,alt:m,className:"w-full h-full object-contain"}),e.jsx(y,{type:"button",variant:"destructive",size:"icon",className:"absolute top-2 right-2 h-6 w-6",onClick:w,disabled:a,children:e.jsx(B,{className:"h-4 w-4"})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center text-muted-foreground",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center mb-2",children:e.jsx("span",{className:"text-2xl font-bold text-primary",children:N()})}),e.jsx(F,{className:"h-6 w-6 opacity-30"})]})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("input",{type:"file",id:"logo-upload",accept:"image/*",onChange:E,disabled:a,className:"hidden"}),e.jsx(b,{htmlFor:"logo-upload",children:e.jsx(y,{type:"button",variant:"outline",disabled:a,asChild:!0,children:e.jsxs("span",{className:"cursor-pointer",children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),a?"Enviando...":"Enviar Logo"]})})}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Formatos: JPG, PNG, GIF",e.jsx("br",{}),"Tamanho máximo: 5MB"]})]})]})]})}export{S as C};
