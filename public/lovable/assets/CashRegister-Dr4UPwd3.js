import{c as be,r,a9 as V,j as e,B as c,C as d,f as x,bT as ee,H as se,A as we,aD as te,bY as Ce,bU as l,b as F,d as T,aa as xe,a6 as re,I as ae,aK as S,b5 as L,aj as me,ab as J,ac as U,ad as ne,ae as le,af as he,ah as ie,aO as je,J as ue,O as ye,aS as _e,b_ as oe,T as Z,bX as De,b4 as Ae}from"./index-v68zVK4x.js";import{B as ce,u as Se,H as de}from"./useCashRegister-D5UMR78Y.js";import{A as ke,a as Me,b as Oe,c as Fe,d as Te,e as He,f as Ie,g as Ee}from"./alert-dialog-DWcOo5bl.js";import{Q as pe}from"./qr-code-D6JTyGnX.js";import{d as Re,a as $e}from"./differenceInMinutes-DzoYFpRw.js";import{A as ze}from"./arrow-left-CrBH0OTH.js";import{T as H}from"./trending-up-Pv8eXQA2.js";import{T as Pe}from"./triangle-alert-pjCGKzCy.js";import{C as ge}from"./circle-check-DnVeMRDK.js";import{E as Be}from"./eye-BTy0yhMb.js";import{D as Ve}from"./dollar-sign-LxBQe3eU.js";import"./useCompanyId-BPuD7pC1.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=be("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);function Le({summary:a,onClose:h,onCancel:t,isClosing:p}){const j=r.useMemo(()=>{var m,_,z,P;const s=[],i=a.opening_amount+(a.total_cash||0)+(a.total_deposits||0)-(a.total_withdrawals||0);if(s.push({type:"cash",name:"Dinheiro",icon:ce,systemAmount:i,countedAmount:""}),(a.total_pix||0)>0&&s.push({type:"pix",name:"PIX",icon:pe,systemAmount:a.total_pix||0,countedAmount:String(a.total_pix||0)}),(a.total_card||0)>0){const D=((_=(m=a.payments_by_type)==null?void 0:m.find(n=>n.type==="credit"))==null?void 0:_.total)||0,A=((P=(z=a.payments_by_type)==null?void 0:z.find(n=>n.type==="debit"))==null?void 0:P.total)||0;D>0&&s.push({type:"credit",name:"Cartão Crédito",icon:V,systemAmount:D,countedAmount:String(D)}),A>0&&s.push({type:"debit",name:"Cartão Débito",icon:V,systemAmount:A,countedAmount:String(A)}),D===0&&A===0&&(a.total_card||0)>0&&s.push({type:"card",name:"Cartão",icon:V,systemAmount:a.total_card||0,countedAmount:String(a.total_card||0)})}return s},[a]),[u,q]=r.useState(()=>{const s={};return j.forEach(i=>{s[i.type]=i.countedAmount}),s}),[g,Q]=r.useState(""),[k,K]=r.useState(""),[I,f]=r.useState(!1),[W,E]=r.useState(!1),R=r.useMemo(()=>{const s={};return j.forEach(i=>{const m=parseFloat(u[i.type]||"0")||0;s[i.type]=m-i.systemAmount}),s},[u,j]),b=r.useMemo(()=>j.reduce((s,i)=>s+i.systemAmount,0),[j]),w=r.useMemo(()=>Object.values(u).reduce((s,i)=>s+(parseFloat(i)||0),0),[u]),o=w-b,N=a.opened_at?new Date(a.opened_at):new Date,M=new Date,$=Re(M,N),C=$e(M,N),Y=C>=1?`${C}h ${$%60}min`:`${$} min`,O=(s,i)=>{q(m=>({...m,[s]:i}))},G=()=>{const s={};Object.entries(u).forEach(([i,m])=>{s[i]=parseFloat(m)||0}),h({closing_amounts:s,closing_notes:k||void 0,justification:o!==0?g:void 0}),f(!1),E(!0)},v=s=>s>0?"text-success":s<0?"text-destructive":"text-muted-foreground",y=s=>s>0?"bg-success/10 border-success/30":s<0?"bg-destructive/10 border-destructive/30":"bg-muted/50";return e.jsxs("div",{className:"p-4 md:p-6 space-y-4 md:space-y-6 pb-32",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(c,{variant:"ghost",size:"icon",onClick:t,children:e.jsx(ze,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-xl md:text-2xl font-bold",children:"Fechamento de Caixa"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Confirme os valores para encerrar o caixa"})]})]}),e.jsx(d,{children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Caixa"}),e.jsx("p",{className:"font-medium",children:a.terminal_name||"#1"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Aberto há"}),e.jsx("p",{className:"font-medium",children:Y})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Operador"}),e.jsx("p",{className:"font-medium truncate",children:a.operator_name||"Operador"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Abertura"}),e.jsx("p",{className:"font-medium",children:te(N,"dd/MM HH:mm",{locale:je})})]})]})]})})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsx(d,{children:e.jsxs(x,{className:"p-3 text-center",children:[e.jsx(Ce,{className:"w-5 h-5 mx-auto text-primary mb-1"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Atendimentos"}),e.jsx("p",{className:"text-lg font-bold",children:a.total_checks||0})]})}),e.jsx(d,{children:e.jsxs(x,{className:"p-3 text-center",children:[e.jsx(H,{className:"w-5 h-5 mx-auto text-success mb-1"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ticket Médio"}),e.jsx("p",{className:"text-lg font-bold",children:l(a.average_ticket||0)})]})}),e.jsx(d,{children:e.jsxs(x,{className:"p-3 text-center",children:[e.jsx(H,{className:"w-5 h-5 mx-auto text-success mb-1"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Suprimentos"}),e.jsxs("p",{className:"text-lg font-bold text-success",children:["+",l(a.total_deposits||0)]})]})}),e.jsx(d,{children:e.jsxs(x,{className:"p-3 text-center",children:[e.jsx(X,{className:"w-5 h-5 mx-auto text-warning mb-1"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Sangrias"}),e.jsxs("p",{className:"text-lg font-bold text-warning",children:["-",l(a.total_withdrawals||0)]})]})})]}),a.movements&&a.movements.length>0&&e.jsxs(d,{children:[e.jsx(F,{className:"py-3",children:e.jsx(T,{className:"text-base",children:"Movimentações do Período"})}),e.jsx(x,{className:"pt-0",children:e.jsx(xe,{className:"max-h-32",children:e.jsx("div",{className:"space-y-2",children:a.movements.map(s=>e.jsxs("div",{className:"flex items-center justify-between text-sm p-2 rounded bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s.movement_type==="withdrawal"?e.jsx(X,{className:"w-4 h-4 text-destructive"}):e.jsx(H,{className:"w-4 h-4 text-success"}),e.jsx("span",{children:s.movement_type==="withdrawal"?"Sangria":"Suprimento"}),s.reason&&e.jsxs("span",{className:"text-muted-foreground",children:["- ",s.reason]})]}),e.jsxs("span",{className:s.movement_type==="withdrawal"?"text-destructive":"text-success",children:[s.movement_type==="withdrawal"?"-":"+",l(s.amount)]})]},s.id))})})})]}),e.jsxs(d,{children:[e.jsx(F,{className:"py-3",children:e.jsx(T,{className:"text-base",children:"Conferência por Forma de Pagamento"})}),e.jsx(x,{className:"pt-0",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs font-medium text-muted-foreground px-2",children:[e.jsx("div",{children:"Forma"}),e.jsx("div",{className:"text-right",children:"Sistema"}),e.jsx("div",{className:"text-right",children:"Contado"}),e.jsx("div",{className:"text-right",children:"Diferença"})]}),e.jsx(re,{}),j.map(s=>{const i=s.icon,m=R[s.type]||0;return e.jsxs("div",{className:`grid grid-cols-4 gap-2 items-center p-2 rounded-lg ${y(m)}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:s.name})]}),e.jsx("div",{className:"text-right font-mono text-sm",children:l(s.systemAmount)}),e.jsx("div",{className:"text-right",children:e.jsx(ae,{type:"number",step:"0.01",value:u[s.type],onChange:_=>O(s.type,_.target.value),className:"h-8 text-right font-mono text-sm max-w-24 ml-auto",placeholder:"0,00"})}),e.jsxs("div",{className:`text-right font-mono text-sm font-bold ${v(m)}`,children:[m>=0?"+":"",l(m)]})]},s.type)})]})})]}),o!==0&&e.jsx(d,{className:"border-warning",children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Pe,{className:"w-5 h-5 text-warning shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("p",{className:"text-sm font-medium",children:["Diferença de ",l(Math.abs(o))," detectada"]}),e.jsx(S,{htmlFor:"justification",className:"text-xs text-muted-foreground",children:"Informe o motivo da diferença (obrigatório)"}),e.jsx(L,{id:"justification",placeholder:"Ex: Erro de troco, falta de conferência...",value:g,onChange:s=>Q(s.target.value),className:"min-h-[60px]"})]})]})})}),e.jsx(d,{children:e.jsxs(x,{className:"p-4",children:[e.jsx(S,{htmlFor:"notes",className:"text-sm",children:"Observações (opcional)"}),e.jsx(L,{id:"notes",placeholder:"Adicione observações sobre o fechamento...",value:k,onChange:s=>K(s.target.value),className:"mt-2"})]})}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-background border-t p-4 shadow-lg z-50",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Sistema"}),e.jsx("p",{className:"text-lg font-bold",children:l(b)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Contado"}),e.jsx("p",{className:"text-lg font-bold",children:l(w)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Diferença"}),e.jsxs("p",{className:`text-lg font-bold ${v(o)}`,children:[o>=0?"+":"",l(o)]}),o!==0&&e.jsx(me,{variant:o>0?"default":"destructive",className:"text-xs mt-1",children:o>0?"Sobra":"Falta"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(c,{variant:"outline",className:"flex-1",onClick:t,children:"Cancelar"}),e.jsx(c,{className:"flex-1",onClick:()=>f(!0),disabled:p||o!==0&&g.length<10,children:p?"Fechando...":"Fechar Caixa"})]})]})}),e.jsx(J,{open:I,onOpenChange:f,children:e.jsxs(U,{children:[e.jsxs(ne,{children:[e.jsx(le,{children:"Confirmar Fechamento de Caixa"}),e.jsx(he,{children:"Revise os dados antes de confirmar"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Total Sistema"}),e.jsx("p",{className:"font-bold text-lg",children:l(b)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Total Contado"}),e.jsx("p",{className:"font-bold text-lg",children:l(w)})]})]}),e.jsx(re,{}),e.jsx("div",{className:`p-3 rounded-lg ${y(o)}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Diferença"}),e.jsxs("span",{className:`font-bold ${v(o)}`,children:[o>=0?"+":"",l(o)]})]})}),o!==0&&g&&e.jsxs("div",{className:"p-3 rounded-lg bg-muted/50",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Justificativa"}),e.jsx("p",{className:"text-sm",children:g})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Operador"}),e.jsx("p",{className:"font-medium",children:a.operator_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Data/Hora"}),e.jsx("p",{className:"font-medium",children:te(new Date,"dd/MM/yyyy HH:mm")})]})]})]}),e.jsxs(ie,{children:[e.jsx(c,{variant:"outline",onClick:()=>f(!1),children:"Voltar"}),e.jsx(c,{onClick:G,disabled:p,children:p?"Fechando...":"Confirmar Fechamento"})]})]})})]})}function Je({open:a,onOpenChange:h}){const t=ue(),p=()=>{h(!1),t("/dashboard")},j=()=>{window.print()},u=()=>{h(!1),t("/caixa/historico")};return e.jsx(J,{open:a,onOpenChange:h,children:e.jsx(U,{className:"sm:max-w-md",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-6 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-success/20 flex items-center justify-center mb-6",children:e.jsx(ge,{className:"w-10 h-10 text-success"})}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Caixa Fechado com Sucesso!"}),e.jsx("p",{className:"text-muted-foreground mb-8",children:"O que deseja fazer agora?"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full",children:[e.jsxs(c,{variant:"outline",className:"flex-1",onClick:p,children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Sair"]}),e.jsxs(c,{variant:"outline",className:"flex-1",onClick:j,children:[e.jsx(_e,{className:"w-4 h-4 mr-2"}),"Imprimir"]}),e.jsxs(c,{className:"flex-1",onClick:u,children:[e.jsx(Be,{className:"w-4 h-4 mr-2"}),"Visualizar"]})]})]})})})}function as(){const a=ue(),{activeRegister:h,summary:t,isLoading:p,isRegisterOpen:j,openRegister:u,closeRegister:q,addMovement:g,deleteMovement:Q,isOpening:k,isClosing:K}=Se(),[I,f]=r.useState(""),[W,E]=r.useState(""),[R,b]=r.useState(""),[w,o]=r.useState(""),[N,M]=r.useState("withdrawal"),[$,C]=r.useState(!1),[Y,O]=r.useState(!1),[G,v]=r.useState(!1),[y,s]=r.useState(null),[i,m]=r.useState(!1),_=()=>{u({opening_amount:parseFloat(I)||0,opening_notes:W||void 0}),C(!1),f(""),E("")},z=async n=>{const fe=Object.values(n.closing_amounts).reduce((Ne,ve)=>Ne+ve,0);let B=n.closing_notes||"";n.justification&&(B=`Justificativa: ${n.justification}${B?` | ${B}`:""}`),await q({closing_amount:fe,closing_notes:B||void 0}),v(!1),m(!0)},P=()=>{g({movement_type:N,amount:parseFloat(R)||0,reason:w||void 0}),O(!1),b(""),o("")},D=()=>{y&&(Q(y),s(null))},A=t?t.opening_amount+t.total_cash+t.total_deposits-t.total_withdrawals:0;return p?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):G&&t?e.jsx(Le,{summary:t,onClose:z,onCancel:()=>v(!1),isClosing:K}):j?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ee,{className:"w-6 h-6"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Caixa"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Aberto em ",h!=null&&h.opened_at?te(new Date(h.opened_at),"dd/MM/yyyy 'às' HH:mm",{locale:je}):""]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>a("/caixa/historico"),children:[e.jsx(de,{className:"w-4 h-4 mr-1"}),"Histórico"]}),e.jsxs(me,{variant:"default",className:"bg-success",children:[e.jsx(ge,{className:"w-3 h-3 mr-1"}),"Aberto"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(d,{children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(Ve,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Fundo Inicial"}),e.jsx("p",{className:"text-xl font-bold",children:l((h==null?void 0:h.opening_amount)||0)})]})]})})}),e.jsx(d,{children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-success/10",children:e.jsx(H,{className:"w-5 h-5 text-success"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Vendas"}),e.jsx("p",{className:"text-xl font-bold text-success",children:l((t==null?void 0:t.total_sales)||0)})]})]})})}),e.jsx(d,{children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-warning/10",children:e.jsx(X,{className:"w-5 h-5 text-warning"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Sangrias"}),e.jsx("p",{className:"text-xl font-bold text-warning",children:l((t==null?void 0:t.total_withdrawals)||0)})]})]})})}),e.jsx(d,{children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-info/10",children:e.jsx(ce,{className:"w-5 h-5 text-info"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Dinheiro Esperado"}),e.jsx("p",{className:"text-xl font-bold",children:l(A)})]})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(d,{children:[e.jsx(F,{children:e.jsx(T,{className:"text-lg",children:"Vendas por Forma de Pagamento"})}),e.jsxs(x,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ce,{className:"w-5 h-5 text-success"}),e.jsx("span",{children:"Dinheiro"})]}),e.jsx("span",{className:"font-bold",children:l((t==null?void 0:t.total_cash)||0)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(V,{className:"w-5 h-5 text-blue-500"}),e.jsx("span",{children:"Cartão"})]}),e.jsx("span",{className:"font-bold",children:l((t==null?void 0:t.total_card)||0)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(pe,{className:"w-5 h-5 text-purple-500"}),e.jsx("span",{children:"PIX"})]}),e.jsx("span",{className:"font-bold",children:l((t==null?void 0:t.total_pix)||0)})]})]})]}),e.jsxs(d,{children:[e.jsxs(F,{className:"flex flex-row items-center justify-between",children:[e.jsx(T,{className:"text-lg",children:"Movimentações"}),e.jsxs(J,{open:Y,onOpenChange:O,children:[e.jsx(oe,{asChild:!0,children:e.jsxs(c,{variant:"outline",size:"sm",children:[e.jsx(Z,{className:"w-4 h-4 mr-1"}),"Nova"]})}),e.jsxs(U,{children:[e.jsx(ne,{children:e.jsx(le,{children:"Nova Movimentação"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(c,{variant:N==="withdrawal"?"default":"outline",className:"flex-1",onClick:()=>M("withdrawal"),children:[e.jsx(De,{className:"w-4 h-4 mr-2"}),"Sangria"]}),e.jsxs(c,{variant:N==="deposit"?"default":"outline",className:"flex-1",onClick:()=>M("deposit"),children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Suprimento"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{children:"Valor"}),e.jsx(ae,{type:"number",step:"0.01",placeholder:"0,00",value:R,onChange:n=>b(n.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{children:"Motivo"}),e.jsx(L,{placeholder:"Descreva o motivo...",value:w,onChange:n=>o(n.target.value)})]})]}),e.jsxs(ie,{children:[e.jsx(c,{variant:"outline",onClick:()=>O(!1),children:"Cancelar"}),e.jsx(c,{onClick:P,children:"Confirmar"})]})]})]})]}),e.jsx(x,{children:e.jsx(xe,{className:"h-[200px]",children:t!=null&&t.movements&&t.movements.length>0?e.jsx("div",{className:"space-y-2",children:t.movements.map(n=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg bg-muted/50 group",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[n.movement_type==="withdrawal"?e.jsx(X,{className:"w-4 h-4 text-destructive"}):e.jsx(H,{className:"w-4 h-4 text-success"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:n.movement_type==="withdrawal"?"Sangria":"Suprimento"}),n.reason&&e.jsx("p",{className:"text-xs text-muted-foreground",children:n.reason})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:`font-bold ${n.movement_type==="withdrawal"?"text-destructive":"text-success"}`,children:[n.movement_type==="withdrawal"?"-":"+",l(n.amount)]}),e.jsx(c,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>s(n.id),children:e.jsx(Ae,{className:"w-3 h-3 text-destructive"})})]})]},n.id))}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground",children:[e.jsx(se,{className:"w-8 h-8 mb-2"}),e.jsx("p",{className:"text-sm",children:"Nenhuma movimentação"})]})})})]})]}),e.jsx(d,{children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Fechar Caixa"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Encerrar as operações e gerar relatório de fechamento"})]}),e.jsx(c,{variant:"destructive",onClick:()=>v(!0),children:"Fechar Caixa"})]})})}),e.jsx(ke,{open:!!y,onOpenChange:()=>s(null),children:e.jsxs(Me,{children:[e.jsxs(Oe,{children:[e.jsx(Fe,{children:"Remover movimentação?"}),e.jsx(Te,{children:"Tem certeza que deseja remover esta movimentação? Esta ação não pode ser desfeita."})]}),e.jsxs(He,{children:[e.jsx(Ie,{children:"Cancelar"}),e.jsx(Ee,{onClick:D,children:"Remover"})]})]})}),e.jsx(Je,{open:i,onOpenChange:m})]}):e.jsx("div",{className:"p-6 max-w-2xl mx-auto",children:e.jsxs(d,{children:[e.jsxs(F,{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 w-16 h-16 rounded-full bg-muted flex items-center justify-center",children:e.jsx(ee,{className:"w-8 h-8 text-muted-foreground"})}),e.jsx(T,{children:"Caixa Fechado"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Abra o caixa para iniciar as vendas do dia"})]}),e.jsxs(x,{className:"space-y-3",children:[e.jsxs(J,{open:$,onOpenChange:C,children:[e.jsx(oe,{asChild:!0,children:e.jsxs(c,{className:"w-full",size:"lg",children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Abrir Caixa"]})}),e.jsxs(U,{children:[e.jsxs(ne,{children:[e.jsx(le,{children:"Abrir Caixa"}),e.jsx(he,{children:"Informe o valor inicial do caixa para começar as operações"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"opening-amount",children:"Valor Inicial (Fundo de Troco)"}),e.jsx(ae,{id:"opening-amount",type:"number",step:"0.01",placeholder:"0,00",value:I,onChange:n=>f(n.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"opening-notes",children:"Observações (opcional)"}),e.jsx(L,{id:"opening-notes",placeholder:"Adicione observações sobre a abertura...",value:W,onChange:n=>E(n.target.value)})]})]}),e.jsxs(ie,{children:[e.jsx(c,{variant:"outline",onClick:()=>C(!1),children:"Cancelar"}),e.jsx(c,{onClick:_,disabled:k,children:k?"Abrindo...":"Confirmar Abertura"})]})]})]}),e.jsxs(c,{variant:"outline",className:"w-full",onClick:()=>a("/caixa/historico"),children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),"Histórico de Caixas"]})]})]})})}export{as as default};
