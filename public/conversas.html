<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Conversas · Ana</title>
  <style>
    :root {
      --wa-bg: #eae6df;
      --wa-left: #ffffff;
      --wa-header: #f0f2f5;
      --wa-line: #e8ecef;
      --wa-text: #111b21;
      --wa-muted: #667781;
      --wa-accent: #00a884;
      --wa-bubble-in: #ffffff;
      --wa-bubble-out: #d9fdd3;
      --wa-active-row: #f0f2f5;
      --panel-width: 420px;
    }
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { height: 100%; overflow: hidden; }
    body {
      background: #111b21;
      color: var(--wa-text);
      font-family: "Segoe UI", "Helvetica Neue", Helvetica, Arial, sans-serif;
      font-size: 15px;
    }
    .app {
      width: 100vw;
      height: 100vh;
      display: grid;
      grid-template-columns: var(--panel-width) 1fr;
    }
    .left, .middle { display: flex; flex-direction: column; min-height: 0; }
    .left  { background: var(--wa-left); border-right: 1px solid var(--wa-line); }
    .middle { background: #efeae2; position: relative; }

    /* ── Header ── */
    .head {
      height: 60px; min-height: 60px;
      padding: 0 16px;
      display: flex; align-items: center; gap: 10px;
      background: var(--wa-header);
      border-bottom: 1px solid var(--wa-line);
      flex-shrink: 0;
    }
    .wa-logo {
      width: 40px; height: 40px; border-radius: 50%;
      background: #25d366;
      display: grid; place-items: center; flex: 0 0 auto;
    }
    .avatar {
      width: 40px; height: 40px; border-radius: 50%;
      background: #dfe5e8;
      display: grid; place-items: center;
      font-size: 14px; font-weight: 700; color: #60717c;
      flex: 0 0 auto; overflow: hidden; cursor: pointer;
    }
    .avatar img { width: 100%; height: 100%; object-fit: cover; display: block; }
    .grow { flex: 1; min-width: 0; }
    .grow .title {
      font-size: 17px; font-weight: 600;
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
    }
    .grow .sub {
      font-size: 13px; color: var(--wa-muted);
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
      margin-top: 1px;
    }
    .icon-btn {
      width: 40px; height: 40px;
      border: none; border-radius: 50%; background: transparent;
      color: #54656f; cursor: pointer;
      display: inline-grid; place-items: center; flex: 0 0 auto;
    }
    .icon-btn:hover { background: rgba(11,20,26,.07); }
    .icon-btn svg { display: block; }

    /* ── Search ── */
    .search { padding: 8px 12px; background: #fff; border-bottom: 1px solid #f0f2f5; flex-shrink: 0; }
    .search-box {
      display: flex; align-items: center; gap: 8px;
      background: #f0f2f5; border-radius: 9px; padding: 7px 12px;
    }
    .search-box input {
      flex: 1; border: none; background: transparent;
      font-size: 15px; color: var(--wa-text); outline: none;
    }
    .search-box input::placeholder { color: var(--wa-muted); }

    /* ── List ── */
    .list { flex: 1; overflow-y: auto; overflow-x: hidden; background: #fff; }
    .conv-item {
      display: flex; align-items: center; gap: 13px;
      padding: 10px 16px;
      border-bottom: 1px solid #f3f5f6;
      cursor: pointer; background: #fff;
    }
    .conv-item:hover  { background: #f7f9fa; }
    .conv-item.active { background: var(--wa-active-row); }
    .conv-av {
      width: 49px; height: 49px; border-radius: 50%;
      background: #dfe5e8;
      display: grid; place-items: center;
      font-size: 15px; font-weight: 700; color: #60717c;
      flex: 0 0 auto; overflow: hidden;
    }
    .conv-av img { width: 100%; height: 100%; object-fit: cover; display: block; }
    .conv-body { flex: 1; min-width: 0; }
    .conv-row { display: flex; justify-content: space-between; align-items: baseline; gap: 4px; }
    .conv-name {
      font-size: 16px; font-weight: 500; color: #111b21;
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
    }
    .conv-time { font-size: 12px; color: var(--wa-muted); white-space: nowrap; flex: 0 0 auto; }
    .conv-preview {
      font-size: 14px; color: var(--wa-muted);
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
      margin-top: 3px;
    }

    /* ── Middle empty state ── */
    #noConvPlaceholder {
      flex: 1; display: flex; flex-direction: column;
      align-items: center; justify-content: center; gap: 20px;
      background: #f8f9fa; padding: 32px; text-align: center;
    }
    #noConvPlaceholder p { font-size: 15px; color: var(--wa-muted); line-height: 1.6; }

    /* ── Messages ── */
    .messages {
      flex: 1; overflow-y: auto; overflow-x: hidden;
      padding: 12px 8.5% 16px;
      background-color: #efeae2;
      background-image:
        radial-gradient(circle at 25px 25px, rgba(208,201,191,.45) 1.2px, transparent 1.3px),
        radial-gradient(circle at 7px  7px,  rgba(208,201,191,.3)  0.9px, transparent 1px);
      background-size: 34px 34px, 22px 22px;
    }
    .msg { display: flex; margin: 2px 0; }
    .msg.user      { justify-content: flex-start; }
    .msg.assistant { justify-content: flex-end; }
    .bubble {
      position: relative;
      max-width: min(72%, 820px);
      border-radius: 8px;
      padding: 6px 8px 18px;
      font-size: 14.2px; line-height: 1.45;
      box-shadow: 0 1px .5px rgba(11,20,26,.13);
      white-space: pre-wrap; word-break: break-word;
    }
    .msg.user .bubble      { background: var(--wa-bubble-in); border-top-left-radius: 0; }
    .msg.assistant .bubble { background: var(--wa-bubble-out); border-top-right-radius: 0; }
    .at { position: absolute; right: 7px; bottom: 3px; font-size: 11px; color: #8696a0; }

    /* ── Composer ── */
    .composer {
      position: relative;
      background: #f0f2f5; border-top: 1px solid #e4e8eb;
      padding: 8px 16px;
      display: flex; align-items: flex-end; gap: 8px;
      flex-shrink: 0;
    }
    .composer textarea {
      flex: 1; min-height: 44px; max-height: 200px;
      border: none; border-radius: 9px;
      background: #fff; padding: 11px 14px;
      font-size: 15px; color: var(--wa-text);
      outline: none; resize: none; line-height: 1.4;
      font-family: inherit; overflow-y: auto;
    }
    .send-btn {
      width: 44px; height: 44px; flex: 0 0 auto;
      border: none; border-radius: 50%;
      background: var(--wa-accent); color: #fff;
      cursor: pointer; display: grid; place-items: center;
    }
    .send-btn:hover { background: #017f63; }

    /* ── Pop-up menus ── */
    .pop {
      position: absolute;
      background: #fff; border-radius: 12px;
      box-shadow: 0 6px 20px rgba(11,20,26,.18);
      border: 1px solid rgba(0,0,0,.06);
      display: none; z-index: 30;
    }
    .pop.open { display: block; }
    .attach-menu { width: 210px; left: 16px; bottom: 66px; padding: 8px 0; }
    .attach-item {
      width: 100%; border: none; background: transparent;
      text-align: left; padding: 9px 16px;
      color: #111b21; font-size: 14.5px;
      cursor: pointer; display: flex; align-items: center; gap: 14px;
    }
    .attach-item:hover { background: #f7f9fa; }
    .attach-dot {
      width: 42px; height: 42px; border-radius: 50%;
      display: grid; place-items: center; flex: 0 0 auto;
    }
    .emoji-menu {
      max-width: 300px; padding: 8px;
      display: grid; grid-template-columns: repeat(8,1fr); gap: 3px;
      left: 60px; bottom: 66px;
    }
    .emoji-item {
      border: none; background: transparent;
      font-size: 22px; cursor: pointer;
      border-radius: 6px; padding: 3px; line-height: 1;
    }
    .emoji-item:hover { background: #f0f2f5; }

    /* ── Status bar ── */
    .status {
      min-height: 26px; padding: 4px 16px 5px;
      font-size: 12px; color: var(--wa-muted);
      background: #f0f2f5; border-top: 1px dashed #d8e0e5;
      flex-shrink: 0;
    }
    .ok   { color: #00a884; }
    .warn { color: #946b00; }
    .err  { color: #cf3b41; }

    /* ── Controls ── */
    .switch {
      display: inline-flex; align-items: center; gap: 6px;
      font-size: 13px; color: #435560; white-space: nowrap; cursor: pointer;
    }
    .switch input { accent-color: var(--wa-accent); cursor: pointer; }
    .btn-danger {
      border: none; border-radius: 16px;
      background: #fbeaea; color: #9b2c2c;
      padding: 7px 12px; font-size: 13px; font-weight: 600;
      cursor: pointer; display: inline-flex; align-items: center; gap: 5px;
      white-space: nowrap;
    }
    .btn-danger:hover { background: #f5c6c6; }

    /* ── Modals ── */
    .modal-backdrop {
      position: fixed; inset: 0;
      display: none; align-items: center; justify-content: center;
      background: rgba(0,0,0,.5); z-index: 100;
    }
    .modal-backdrop.open { display: flex; }
    .modal {
      width: min(560px, 94vw);
      border-radius: 12px; background: #fff;
      border: 1px solid #dde3e7; padding: 20px;
    }
    .modal h3 { font-size: 17px; margin-bottom: 12px; }
    .field { margin-bottom: 14px; }
    .field label { font-size: 13px; color: #435560; display: block; margin-bottom: 5px; font-weight: 500; }
    .field input, .field textarea {
      width: 100%; border: 1px solid #d2dbe0; border-radius: 8px;
      background: #fff; padding: 10px 12px; font-size: 14px;
      color: var(--wa-text); outline: none; font-family: inherit;
    }
    .field input:focus, .field textarea:focus { border-color: var(--wa-accent); }
    .field textarea { min-height: 90px; resize: vertical; }
    .modal-actions { display: flex; justify-content: flex-end; gap: 8px; margin-top: 16px; }
    .btn {
      border: 1px solid #d1dbe1; border-radius: 8px;
      background: #fff; color: var(--wa-text);
      padding: 9px 18px; cursor: pointer; font-size: 14px;
    }
    .btn:hover { background: #f5f7f8; }
    .btn.primary { background: var(--wa-accent); border-color: var(--wa-accent); color: #fff; font-weight: 600; }
    .btn.primary:hover { background: #017f63; }
    .btn.danger  { background: #c0392b; border-color: #c0392b; color: #fff; font-weight: 600; }
    .btn.danger:hover  { background: #a93226; }

    /* ── Scrollbars ── */
    .list::-webkit-scrollbar, .messages::-webkit-scrollbar { width: 4px; }
    .list::-webkit-scrollbar-thumb, .messages::-webkit-scrollbar-thumb { background: #ced7dc; border-radius: 999px; }
    .list::-webkit-scrollbar-track, .messages::-webkit-scrollbar-track { background: transparent; }

    /* ── Contact header button ── */
    .contact-info-btn {
      display: flex; align-items: center; gap: 10px;
      background: none; border: none; cursor: pointer;
      padding: 4px 6px; border-radius: 8px; text-align: left;
      flex: 1; min-width: 0;
    }
    .contact-info-btn:hover { background: rgba(0,0,0,.05); }

    /* ── Contact side panel ── */
    .contact-panel {
      position: absolute; top: 0; right: 0; bottom: 0;
      width: 320px; background: #fff;
      border-left: 1px solid var(--wa-line);
      display: flex; flex-direction: column;
      z-index: 10; box-shadow: -4px 0 16px rgba(0,0,0,.08);
      transform: translateX(100%);
      transition: transform .22s ease;
    }
    .contact-panel.open { transform: translateX(0); }
    .cp-head {
      height: 60px; min-height: 60px;
      display: flex; align-items: center; gap: 10px;
      padding: 0 16px;
      background: var(--wa-header);
      border-bottom: 1px solid var(--wa-line);
      font-size: 15px; font-weight: 600; flex-shrink: 0;
    }
    .cp-head button { margin-right: 4px; }
    .cp-body {
      flex: 1; overflow-y: auto; padding: 24px 20px;
      display: flex; flex-direction: column; align-items: center; gap: 8px;
    }
    .cp-avatar {
      width: 80px; height: 80px; border-radius: 50%;
      background: #d1dbe0; display: flex; align-items: center; justify-content: center;
      font-size: 28px; font-weight: 700; color: #fff;
      overflow: hidden; margin-bottom: 4px; flex-shrink: 0;
    }
    .cp-avatar img { width: 100%; height: 100%; object-fit: cover; border-radius: 50%; }
    .cp-name { font-size: 18px; font-weight: 700; color: var(--wa-text); text-align: center; word-break: break-word; }
    .cp-phone { font-size: 14px; color: var(--wa-muted); }
    .cp-state { font-size: 12px; color: var(--wa-accent); font-weight: 600; margin-top: 4px; }
    .cp-divider { width: 100%; height: 1px; background: var(--wa-line); margin: 12px 0; }
    .cp-label { font-size: 11px; text-transform: uppercase; color: var(--wa-muted); font-weight: 600; letter-spacing: .5px; align-self: flex-start; }
    .cp-value { font-size: 14px; color: var(--wa-text); align-self: flex-start; margin-bottom: 8px; }
    .cp-body .btn.danger { margin-top: 16px; width: 100%; justify-content: center; }

    @media (max-width: 900px) {
      .app { grid-template-columns: 1fr; }
      .left  { max-height: 40vh; border-right: none; border-bottom: 1px solid var(--wa-line); }
      .middle { min-height: 60vh; }
      .contact-panel { width: 100%; }
    }
  </style>
</head>
<body>
<div class="app">

  <!-- ═══ LEFT PANEL ═══ -->
  <section class="left">
    <div class="head">
      <div class="wa-logo">
        <svg viewBox="0 0 32 32" width="24" height="24" fill="white" xmlns="http://www.w3.org/2000/svg">
          <path d="M16 2C8.27 2 2 8.27 2 16c0 2.41.64 4.66 1.74 6.62L2 30l7.57-1.72C11.4 29.37 13.64 30 16 30c7.73 0 14-6.27 14-14S23.73 2 16 2zm0 25.6c-1.87 0-3.66-.5-5.22-1.37l-.37-.22-3.87 1 1.03-3.76-.24-.38A11.48 11.48 0 014.4 16C4.4 9.6 9.6 4.4 16 4.4S27.6 9.6 27.6 16 22.4 27.6 16 27.6zm6.37-8.4c-.35-.17-2.06-.99-2.38-1.1s-.55-.17-.78.17c-.23.35-.9 1.1-1.1 1.33s-.4.26-.76.09c-.35-.17-1.49-.54-2.84-1.73-1.05-.93-1.75-2.07-1.96-2.42s-.02-.54.16-.71c.16-.15.35-.4.52-.6s.23-.35.34-.58.06-.44-.03-.61c-.09-.17-.78-1.87-1.07-2.56-.28-.67-.57-.58-.78-.59h-.67c-.23 0-.6.09-.91.44s-1.2 1.17-1.2 2.85 1.23 3.31 1.4 3.54c.18.23 2.43 3.71 5.89 5.2.82.36 1.46.57 1.96.73.82.26 1.57.22 2.16.13.66-.1 2.04-.83 2.33-1.63s.29-1.49.2-1.63c-.09-.14-.32-.23-.67-.4z"/>
        </svg>
      </div>
      <div class="grow">
        <div class="title">WhatsApp</div>
        <div id="instanceInfo" class="sub">Instância: carregando...</div>
      </div>
      <button id="refreshBtn" class="icon-btn" title="Atualizar lista">
        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="23 4 23 10 17 10"/>
          <polyline points="1 20 1 14 7 14"/>
          <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/>
        </svg>
      </button>
    </div>

    <div class="search">
      <div class="search-box">
        <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="#8696a0" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/>
        </svg>
        <input id="searchInput" placeholder="Pesquisar conversas" />
      </div>
    </div>

    <div id="list" class="list"></div>
  </section>

  <!-- ═══ RIGHT PANEL ═══ -->
  <section class="middle" id="middlePanel">

    <!-- No conversation selected placeholder -->
    <div id="noConvPlaceholder" style="display:flex">
      <svg viewBox="0 0 303 172" width="220" opacity=".08" fill="#00a884">
        <path d="M229 0H74C33.1 0 0 33.1 0 74v24c0 40.9 33.1 74 74 74h4l-4 30 52.7-30H229c40.9 0 74-33.1 74-74V74c0-40.9-33.1-74-74-74z"/>
      </svg>
      <p>Selecione uma conversa<br>para começar a ler o histórico</p>
    </div>

    <!-- Chat header (hidden until conversation selected) -->
    <div class="head" id="chatHeader" style="display:none">
      <button id="contactInfoBtn" class="contact-info-btn" title="Ver informações do contato">
        <div id="contactProfile" class="avatar">
          <svg viewBox="0 0 24 24" width="22" height="22" fill="#aab8c0">
            <path d="M12 12c2.7 0 4.8-2.1 4.8-4.8S14.7 2.4 12 2.4 7.2 4.5 7.2 7.2 9.3 12 12 12zm0 2.4c-3.2 0-9.6 1.6-9.6 4.8v2.4h19.2v-2.4c0-3.2-6.4-4.8-9.6-4.8z"/>
          </svg>
        </div>
        <div class="grow">
          <div id="contactName" class="title">—</div>
          <div id="contactPhone" class="sub">—</div>
          <div id="contactState" class="sub" style="font-size:11px"></div>
        </div>
      </button>
      <label class="switch" title="Desabilitar respostas automáticas da Ana para este contato">
        <input id="pauseToggle" type="checkbox" disabled />
        <span>Desabilitar Ana</span>
      </label>
      <label class="switch">
        <input id="blockToggle" type="checkbox" disabled />
        <span>Bloquear</span>
      </label>
      <button id="clearContextBtn" class="btn-danger" title="Limpar contexto e memória do cliente" style="display:none">
        <svg viewBox="0 0 24 24" width="13" height="13" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="3 6 5 6 21 6"/>
          <path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"/>
          <path d="M10 11v6"/><path d="M14 11v6"/>
          <path d="M9 6V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"/>
        </svg>
        Limpar
      </button>
      <button id="agentSettingsBtn" class="icon-btn" title="Configurações do agente">
        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="3"/>
          <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/>
        </svg>
      </button>
    </div>

    <div id="messages" class="messages" style="display:none"></div>

    <!-- Contact info side panel -->
    <div id="contactPanel" class="contact-panel">
      <div class="cp-head">
        <button id="closeContactPanel" class="icon-btn" title="Fechar">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
        Informações do contato
      </div>
      <div class="cp-body">
        <div id="panelAvatar" class="cp-avatar">
          <svg viewBox="0 0 24 24" width="40" height="40" fill="#aab8c0">
            <path d="M12 12c2.7 0 4.8-2.1 4.8-4.8S14.7 2.4 12 2.4 7.2 4.5 7.2 7.2 9.3 12 12 12zm0 2.4c-3.2 0-9.6 1.6-9.6 4.8v2.4h19.2v-2.4c0-3.2-6.4-4.8-9.6-4.8z"/>
          </svg>
        </div>
        <div id="panelName" class="cp-name">—</div>
        <div id="panelPhone" class="cp-phone">—</div>
        <div id="panelState" class="cp-state"></div>
        <div class="cp-divider"></div>
        <div class="cp-label">Telefone</div>
        <div id="panelPhoneDetail" class="cp-value">—</div>
        <div class="cp-label">Estado da conversa</div>
        <div id="panelStateDetail" class="cp-value">—</div>
        <div class="cp-divider"></div>
        <button id="deleteConversationBtn" class="btn danger">
          <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right:6px">
            <polyline points="3 6 5 6 21 6"/>
            <path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"/>
            <path d="M10 11v6"/><path d="M14 11v6"/>
            <path d="M9 6V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"/>
          </svg>
          Excluir conversa
        </button>
      </div>
    </div>

    <!-- Composer (hidden until conversation selected) -->
    <div class="composer" id="composerBar" style="display:none">
      <button id="emojiBtn" class="icon-btn" title="Emoji">
        <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="#54656f" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"/>
          <path d="M8 14s1.5 2 4 2 4-2 4-2"/>
          <line x1="9" y1="9" x2="9.01" y2="9"/>
          <line x1="15" y1="9" x2="15.01" y2="9"/>
        </svg>
      </button>
      <button id="attachBtn" class="icon-btn" title="Anexar">
        <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="#54656f" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"/>
        </svg>
      </button>
      <textarea id="textInput" placeholder="Digite uma mensagem" rows="1"></textarea>
      <button id="sendBtn" class="send-btn" title="Enviar">
        <svg viewBox="0 0 24 24" width="22" height="22" fill="white">
          <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
        </svg>
      </button>

      <!-- Attachment menu -->
      <div id="attachMenu" class="pop attach-menu">
        <button type="button" id="pickDocumentBtn" class="attach-item">
          <span class="attach-dot" style="background:#7b61ff">
            <svg viewBox="0 0 24 24" width="20" height="20" fill="white"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8" fill="none" stroke="white" stroke-width="2" stroke-linecap="round"/></svg>
          </span>
          Documento
        </button>
        <button type="button" id="pickMediaBtn" class="attach-item">
          <span class="attach-dot" style="background:#2d8cff">
            <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5" fill="white" stroke="none"/><polyline points="21 15 16 10 5 21"/></svg>
          </span>
          Fotos e vídeos
        </button>
        <button type="button" id="recordBtn" class="attach-item">
          <span class="attach-dot" style="background:#ff7a1a" id="recordDot">
            <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
              <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
              <line x1="12" y1="19" x2="12" y2="23"/>
              <line x1="8" y1="23" x2="16" y2="23"/>
            </svg>
          </span>
          <span id="recordLabel">Áudio</span>
        </button>
        <button type="button" id="sendLocationBtn" class="attach-item">
          <span class="attach-dot" style="background:#00a884">
            <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
              <circle cx="12" cy="10" r="3"/>
            </svg>
          </span>
          Localização
        </button>
        <button type="button" id="sendPixBtn" class="attach-item">
          <span class="attach-dot" style="background:#00c281">
            <svg viewBox="0 0 24 24" width="20" height="20" fill="white">
              <path d="M11.944 17.97L4.58 13.62 11.943 24l7.37-10.38-7.37 4.35zm.112-15.97L4.58 13.38l7.477 4.46L19.42 13.38 12.057 2z"/>
            </svg>
          </span>
          Pix
        </button>
        <button type="button" id="sendMenuBtn" class="attach-item">
          <span class="attach-dot" style="background:#f6b100">
            <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round">
              <line x1="8" y1="6"  x2="21" y2="6"/>
              <line x1="8" y1="12" x2="21" y2="12"/>
              <line x1="8" y1="18" x2="21" y2="18"/>
              <line x1="3" y1="6"  x2="3.01" y2="6"/>
              <line x1="3" y1="12" x2="3.01" y2="12"/>
              <line x1="3" y1="18" x2="3.01" y2="18"/>
            </svg>
          </span>
          Cardápio
        </button>
      </div>

      <!-- Emoji menu -->
      <div id="emojiMenu" class="pop emoji-menu"></div>

      <input id="fileInput" type="file" hidden />
    </div>

    <div id="status" class="status">Carregando inbox...</div>
  </section>
</div>

<!-- ═══ Modal: Limpar contexto ═══ -->
<div id="clearContextModal" class="modal-backdrop">
  <div class="modal">
    <h3 style="color:#c0392b">⚠️ Limpar contexto e memória</h3>
    <p style="font-size:14px;color:#435560;line-height:1.6;margin-bottom:4px">
      Isso apagará <strong>completamente</strong> a conversa atual, o nome salvo, o histórico de pedidos
      e todos os dados do cliente em memória.<br><br>
      Na próxima interação a Ana tratará este contato como um <strong>cliente novo</strong>.
    </p>
    <p id="clearContextPhone" style="font-size:13px;color:#8696a0;margin-top:6px"></p>
    <div class="modal-actions">
      <button id="cancelClearBtn" class="btn">Cancelar</button>
      <button id="confirmClearBtn" class="btn danger">Sim, limpar tudo</button>
    </div>
  </div>
</div>

<!-- ═══ Modal: Configurações do agente ═══ -->
<div id="agentSettingsModal" class="modal-backdrop">
  <div class="modal">
    <h3>Configurações do agente</h3>
    <div class="field">
      <label for="bufferSecondsInput">Tempo de buffer de mensagens (segundos)</label>
      <input id="bufferSecondsInput" type="number" min="3" max="120" step="1" />
    </div>
    <div class="field">
      <label for="greetingMessageInput">Mensagem de saudação (1× por dia)</label>
      <textarea id="greetingMessageInput"></textarea>
    </div>
    <div class="modal-actions">
      <button id="closeAgentSettingsBtn" class="btn">Cancelar</button>
      <button id="saveAgentSettingsBtn" class="btn primary">Salvar</button>
    </div>
  </div>
</div>

<script src="/conversas.js"></script>
</body>
</html>
